/*!
 * license inazumatv.com
 * author (at)taikiken / http://inazumatv.com
 * date 2015/04/20 - 16:51
 *
 * Copyright (c) 2011-2015 inazumatv.com, inc.
 *
 * Distributed under the terms of the MIT license.
 * http://www.opensource.org/licenses/mit-license.html
 *
 * This notice shall be included in all copies or substantial portions of the Software.
 *
 * thanks
 * gl-matrix
 * https://github.com/toji/gl-matrix
 *
 * html5rocks.com
 * http://www.html5rocks.com/en/tutorials/canvas/imagefilters/
 *
 * Blur by Mario Klingemann
 * http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html
 *
 * version 0.0.1
 * build 2015-09-10 20:08:41
 * git https://github.com/taikiken/igata.js
 *
 */
var Igata=window.Igata||{};!function(t,r){"use strict";function e(t){return 65280&t}function a(t){return 255&t}function n(t){return y[(65280&t)>>8]}var o=r;o.Float32Array=t.Float32Array,o._random=Math.random,o._abs=Math.abs,o._min=Math.min,o._max=Math.max,o._sqrt=Math.sqrt,o._cos=Math.cos,o._sin=Math.sin,o._round=Math.round,o._floor=Math.floor,o._exp=Math.exp,o._PI=Math.PI,o.extend=function(t,r){r.prototype=Object.create(t.prototype),r.prototype.constructor=r};var f=1.192092896e-7,i=1e-37,u=256,s=512,c=1024,h=2048,d=4096,l=1,p=2,v=3,g=4,y=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8]),w=0,x=1,m=2,_=3,b=1,M=1,B=2;o.U8_t=u,o.S32_t=s,o.F32_t=c,o.S64_t=h,o.F64_t=d,o.C1_t=l,o.C2_t=p,o.C3_t=v,o.C4_t=g,o.U8C1_t=u|l,o.U8C3_t=u|v,o.U8C4_t=u|g,o.F32C1_t=c|l,o.F32C2_t=c|p,o.S32C1_t=s|l,o.S32C2_t=s|p,o.EPSILON=f,o.FLT_MIN=i,o.COLOR_RGBA2GRAY=w,o.COLOR_RGB2GRAY=x,o.COLOR_BGRA2GRAY=m,o.COLOR_BGR2GRAY=_,o.BOX_BLUR_NOSCALE=b,o.SVD_U_T=M,o.SVD_V_T=B,o.get_data_type=e,o.get_channel=a,o.get_data_type_size=n}(window,Igata),function(t){"use strict";var r=t.Igata;r.Bitmap=function(){function t(t,r){this.identity=null,Object.defineProperties(this,{context:{get:function(){return t}},img:{get:function(){return r}}})}var r=t.prototype;return r.constructor=t,r.get=function(t,r,e,a){var n=this.context,o=this.img;return o&&(e=e||o.width,a=a||o.height),t=t||0,r=r||0,n.getImageData(t,r,e,a)},r.save=function(t){this.identity=new Uint8ClampedArray(t)},t}()}(window),function(t){"use strict";var r=t.Igata;r.Filter=function(){function t(t){Object.defineProperties(this,{bitmap:{get:function(){return t},set:function(r){t=r}}})}var r=t.prototype;return r.constructor=t,r.filter=function(){},r.imageData=function(t){var r=t.get();return t.identity||t.save(r.data),r},r.restore=function(){var t,r=this.bitmap,e=r.get(),a=r.identity;a&&(e.data.set(a),t=r.context,t.putImageData(e,0,0))},t}()}(window),function(t){"use strict";var r=t.Igata;r.Invert=function(){function t(t){e.call(this,t)}var e=r.Filter;r.extend(e,t);var a=t.prototype;return a.constructor=t,a.filter=function(){var t,r,e,a,n=this.bitmap,o=n.context,f=this.imageData(n);for(t=f.data,r=0,e=t.length;e>r;r=r+4|0)a=r,t[a]=255-t[a],a=r+1,t[a]=255-t[a],a=r+2,t[a]=255-t[a];o.putImageData(f,0,0)},t}()}(window),function(t){"use strict";var r=t.Igata;r.Brightness=function(){function t(t){e.call(this,t)}var e=r.Filter;r.extend(e,t);var a=t.prototype;return a.constructor=t,a.filter=function(t){var r,e,a,n,o,f=this.bitmap,i=f.context,u=this.imageData(f);for(r=new Uint8ClampedArray(f.identity),e=2.55*t,n=0,o=r.length;o>n;n=n+4|0)a=n,r[a]=e+r[a],a=n+1,r[a]=e+r[a],a=n+2,r[a]=e+r[a];u.data.set(r),i.putImageData(u,0,0)},t}()}(window),function(t){"use strict";var r=t.Igata;r.Grayscale=function(){function t(t){e.call(this,t)}var e=r.Filter;r.extend(e,t);var a=t.prototype;return a.constructor=t,a.filter=function(){var r=this.bitmap,e=r.context,a=this.imageData(r);t.to(a.data),e.putImageData(a,0,0)},t.to=function(t){var r,e,a,n,o,f,i;for(r=0,e=t.length;e>r;r=r+4|0)a=r+1,n=r+2,o=t[r],f=t[a],i=t[n],t[r]=t[a]=t[n]=.2126*o+.7152*f+.0722*i},t}()}(window),function(t){"use strict";var r=t.Igata;r.Sepia=function(){function t(t){e.call(this,t)}var e=r.Filter;r.extend(e,t);var a=t.prototype;return a.constructor=t,a.filter=function(){var t,r,e,a,n,o,f,i,u=this.bitmap,s=u.context,c=this.imageData(u);for(t=c.data,r=0,e=t.length;e>r;r=r+4|0)a=r+1,n=r+2,o=t[r],f=t[a],i=t[n],t[r]=.393*o+.769*f+.189*i,t[a]=.349*o+.686*f+.168*i,t[n]=.272*o+.534*f+.131*i;s.putImageData(c,0,0)},t}()}(window),function(t){"use strict";var r=t.Igata;r.Threshold=function(){function t(t){e.call(this,t)}var e=r.Filter;r.extend(e,t);var a=t.prototype;return a.constructor=t,a.filter=function(t){var r,e,a,n,o,f,i,u,s,c=this.bitmap,h=c.context,d=this.imageData(c);for(t=t||128,r=d.data,e=0,a=r.length;a>e;e=e+4|0)i=e+1,u=e+2,n=r[e],o=r[i],f=r[u],s=.2126*n+.7152*o+.0722*f>=t?255:0,r[e]=r[i]=r[u]=s;h.putImageData(d,0,0)},t}()}(window),function(t){"use strict";var r=t.Igata,e=function(){function t(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var r=t.prototype;return r.constructor=t,t}();r.Blur=function(){function t(t){a.call(this,t)}var a=r.Filter,n=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];r.extend(a,t);var f=t.prototype;return f.constructor=t,f.filter=function(t,r){var e,a=this.bitmap,n=a.context,o=this.imageData(a);e=new Uint8ClampedArray(a.identity),isNaN(t)&&(t=8),t|=0,0!==t?(r?this._rgba(e,t,o.width,o.height):this._rgb(e,t,o.width,o.height),o.data.set(e),n.putImageData(o,0,0)):this.restore()},f._rgba=function(t,r,a,f){var i,u,s,c,h,d,l,p,v,g,y,w,x,m,_,b,M,B,k,I,z,A,C,D,S,O=r+r+1,R=a-1,q=f-1,F=r+1,L=F*(F+1)/2,E=new e,T=E;for(s=1;O>s;s=s+1|0)T=T.next=new e,s===F&&(S=T);T.next=E;var U=null,G=null;l=d=0;var P=n[r],N=o[r];for(u=0;f>u;u=u+1|0){for(b=M=B=k=p=v=g=y=0,w=F*(I=t[d]),x=F*(z=t[d+1]),m=F*(A=t[d+2]),_=F*(C=t[d+3]),p+=L*I,v+=L*z,g+=L*A,y+=L*C,T=E,s=0;F>s;s=s+1|0)T.r=I,T.g=z,T.b=A,T.a=C,T=T.next;for(s=1;F>s;s=s+1|0)c=d+((s>R?R:s)<<2),p+=(T.r=I=t[c])*(D=F-s),v+=(T.g=z=t[c+1])*D,g+=(T.b=A=t[c+2])*D,y+=(T.a=C=t[c+3])*D,b+=I,M+=z,B+=A,k+=C,T=T.next;for(U=E,G=S,i=0;a>i;i=i+1|0)t[d+3]=C=y*P>>N,0!==C?(C=255/C,t[d]=(p*P>>N)*C,t[d+1]=(v*P>>N)*C,t[d+2]=(g*P>>N)*C):t[d]=t[d+1]=t[d+2]=0,p-=w,v-=x,g-=m,y-=_,w-=U.r,x-=U.g,m-=U.b,_-=U.a,c=l+((c=i+r+1)<R?c:R)<<2,b+=U.r=t[c],M+=U.g=t[c+1],B+=U.b=t[c+2],k+=U.a=t[c+3],p+=b,v+=M,g+=B,y+=k,U=U.next,w+=I=G.r,x+=z=G.g,m+=A=G.b,_+=C=G.a,b-=I,M-=z,B-=A,k-=C,G=G.next,d=d+4|0;l+=a}for(i=0;a>i;i=i+1|0){for(M=B=k=b=v=g=y=p=0,d=i<<2,w=F*(I=t[d]),x=F*(z=t[d+1]),m=F*(A=t[d+2]),_=F*(C=t[d+3]),p+=L*I,v+=L*z,g+=L*A,y+=L*C,T=E,h=a,s=0;F>s;s=s+1|0)T.r=I,T.g=z,T.b=A,T.a=C,T=T.next;for(s=1;r>=s;s=s+1|0)d=h+i<<2,p+=(T.r=I=t[d])*(D=F-s),v+=(T.g=z=t[d+1])*D,g+=(T.b=A=t[d+2])*D,y+=(T.a=C=t[d+3])*D,b+=I,M+=z,B+=A,k+=C,T=T.next,q>s&&(h+=a);for(d=i,U=E,G=S,u=0;f>u;u=u+1|0)c=d<<2,t[c+3]=C=y*P>>N,C>0?(C=255/C,t[c]=(p*P>>N)*C,t[c+1]=(v*P>>N)*C,t[c+2]=(g*P>>N)*C):t[c]=t[c+1]=t[c+2]=0,p-=w,v-=x,g-=m,y-=_,w-=U.r,x-=U.g,m-=U.b,_-=U.a,c=i+((c=u+F)<q?c:q)*a<<2,p+=b+=U.r=t[c],v+=M+=U.g=t[c+1],g+=B+=U.b=t[c+2],y+=k+=U.a=t[c+3],U=U.next,w+=I=G.r,x+=z=G.g,m+=A=G.b,_+=C=G.a,b-=I,M-=z,B-=A,k-=C,G=G.next,d+=a}},f._rgb=function(t,r,a,f){var i,u,s,c,h,d,l,p,v,g,y,w,x,m,_,b,M,B,k,I,z,A=r+r+1,C=a-1,D=f-1,S=r+1,O=S*(S+1)/2,R=new e,q=R;for(s=1;A>s;s=s+1|0)q=q.next=new e,s===S&&(z=q);q.next=R;var F=null,L=null;l=d=0;var E=n[r],T=o[r];for(u=0;f>u;u=u+1|0){for(m=_=b=p=v=g=0,y=S*(M=t[d]),w=S*(B=t[d+1]),x=S*(k=t[d+2]),p+=O*M,v+=O*B,g+=O*k,q=R,s=0;S>s;s=s+1|0)q.r=M,q.g=B,q.b=k,q=q.next;for(s=1;S>s;s=s+1|0)c=d+((s>C?C:s)<<2),p+=(q.r=M=t[c])*(I=S-s),v+=(q.g=B=t[c+1])*I,g+=(q.b=k=t[c+2])*I,m+=M,_+=B,b+=k,q=q.next;for(F=R,L=z,i=0;a>i;i=i+1|0)t[d]=p*E>>T,t[d+1]=v*E>>T,t[d+2]=g*E>>T,p-=y,v-=w,g-=x,y-=F.r,w-=F.g,x-=F.b,c=l+((c=i+r+1)<C?c:C)<<2,m+=F.r=t[c],_+=F.g=t[c+1],b+=F.b=t[c+2],p+=m,v+=_,g+=b,F=F.next,y+=M=L.r,w+=B=L.g,x+=k=L.b,m-=M,_-=B,b-=k,L=L.next,d=d+4|0;l+=a}for(i=0;a>i;i=i+1|0){for(_=b=m=v=g=p=0,d=i<<2,y=S*(M=t[d]),w=S*(B=t[d+1]),x=S*(k=t[d+2]),p+=O*M,v+=O*B,g+=O*k,q=R,h=a,s=0;S>s;s=s+1|0)q.r=M,q.g=B,q.b=k,q=q.next;for(s=1;r>=s;s=s+1|0)d=h+i<<2,p+=(q.r=M=t[d])*(I=S-s),v+=(q.g=B=t[d+1])*I,g+=(q.b=k=t[d+2])*I,m+=M,_+=B,b+=k,q=q.next,D>s&&(h+=a);for(d=i,F=R,L=z,u=0;f>u;u=u+1|0)c=d<<2,t[c]=p*E>>T,t[c+1]=v*E>>T,t[c+2]=g*E>>T,p-=y,v-=w,g-=x,y-=F.r,w-=F.g,x-=F.b,c=i+((c=u+S)<D?c:D)*a<<2,p+=m+=F.r=t[c],v+=_+=F.g=t[c+1],g+=b+=F.b=t[c+2],F=F.next,y+=M=L.r,w+=B=L.g,x+=k=L.b,m-=M,_-=B,b-=k,L=L.next,d+=a}},t}()}(window),function(t){"use strict";var r=t.Igata;r.Convolution=function(){function t(t){e.call(this,t)}var e=r.Filter,a=r._round,n=r._sqrt,o=r._floor,f=r._PI,i=r._exp;r.extend(e,t);var u=t.prototype;return u.constructor=t,u.filter=function(t){var r,e=this.bitmap,a=e.context,n=this.imageData(e);"undefined"==typeof t&&(t=[1,1,1,1,.7,-1,-1,-1,-1]),r=this.convolute(a,n,t,!0),a.putImageData(r,0,0)},u.sharpen=function(t){var r,e=this.bitmap,a=e.context,n=this.imageData(e),o=[0,-1,0,-1,5,-1,0,-1,0];t=!!t,r=this.convolute(a,n,o,t),a.putImageData(r,0,0)},u.blur=function(t){(isNaN(t)||0>=t)&&(t=1/9);var r,e=this.bitmap,a=e.context,n=this.imageData(e),o=[t,t,t,t,t,t,t,t,t];r=this.convolute(a,n,o,!1),a.putImageData(r,0,0)},u.gaussian=function(t){var r,e,a,o=this.bitmap,u=o.context,s=this.imageData(o),c=[],h=.849321800288,d=1/n(2*f)/h,l=0;for(e=-t;t>=e;e++)for(a=-t;t>=a;a++)l=d*i(-(a*a+e*e)/(2*h*h)),c.push(l);console.log("gaussian ",t,c),r=this.convolute(u,s,c,!1),u.putImageData(r,0,0)},u.convolute=function(t,r,e,f){var i,u,s,c,h,d,l,p,v,g,y,w,x,m,_,b=a(n(e.length)),M=o(.5*b),B=r.data,k=r.width,I=r.height,z=k,A=I,C=t.createImageData(z,A),D=C.data,S=f?1:0;for(i=0;A>i;i=i+1|0)for(u=0;z>u;u=u+1|0){for(s=i,c=u,h=4*(i*z+u),d=0,l=0,p=0,v=0,g=0;b>g;g=g+1|0)for(y=0;b>y;y=y+1|0)w=s+g-M,x=c+y-M,w>=0&&I>w&&x>=0&&k>x&&(m=4*(w*k+x),_=e[g*b+y],d+=B[m]*_,l+=B[m+1]*_,p+=B[m+2]*_,v+=B[m+3]*_);D[h]=d,D[h+1]=l,D[h+2]=p,D[h+3]=v+S*(255-v)}return C},t}()}(window),function(t){"use strict";var r=(t.document,t.Igata);r.Match=function(){function t(){}var e=r._abs,a=r._sqrt,n=t.prototype;return n.constructor=t,t.overall=function(t,r,e){var a,n,o=t[0].length===r[0].length?t[0].length:null,f=t.length===r.length?t.length:null;if(null===o||null===f)throw new Error("Matrices don't have the same size.");for(a=0;o>a;a=a+1|0)for(n=0;f>n;n=n+1|0)e(t[a][n],r[a][n])},t.mean=function(t){var r,e,a=0,n=t[0].length,o=t.length;for(r=0;n>r;r=r+1|0)for(e=0;o>e;e=e+1|0)a+=t[r][e];return console.log("mean ",a,n,o,a/(n*o)),a/(n*o)},t.sad=function(r,a){var n=0;return t.overall(r,a,function(t,r){n+=e(t-r)}),n},t.ssd=function(r,e){var a=0;return t.overall(r,e,function(t,r){var e=t-r;a+=e*e}),a},t.zncc=function(r,e){var n,o=t.mean(r),f=t.mean(e),i=0,u=0,s=0;return t.overall(r,e,function(t,r){var e=t-o,a=r-f;i+=e*a,u+=e*e,s+=a*a}),n=a(u*s),i/n},t}()}(window),function(t){"use strict";var r=(t.document,t.Igata);r.Template=function(){function t(){}var e=r.Grayscale,a=r._abs,n=t.prototype;return n.constructor=t,n.match=function(t,r,a){var n,o,f,i,u,s,c,h,d,l,p,v,g,y=new Uint8ClampedArray(t.data),w=new Uint8ClampedArray(r.data);for(a=a||.9,e.to(y),e.to(w),n=t.height,o=t.width,f=r.height,i=r.width,u=0,s=n-f+1;s>u;u=u+1|0)for(c=0,h=o-i+1;h>c;c=c+1|0)for(p=0,d=0;f>d;d=d+1|0)for(l=0;i>l;l=l+1|0)g=l+i*d,v=c+l+o*(u+d),y[v]===w[g]&&(p=p+1|0);return p>=i*f*a},n.sad=function(t,r,n){var o,f,i,u,s,c,h,d,l,p,v,g,y,w,x,m,_,b=new Uint8ClampedArray(t.data),M=new Uint8ClampedArray(r.data);n=n||.2,e.to(b),e.to(M),o=t.height,f=t.width,i=r.height,u=r.width,_=u*i*256;var B=Date.now();for(console.log("sad ",B),s=0,c=o-i+1;c>s;s=s+1|0)for(h=0,d=f-u+1;d>h;h=h+1|0){for(v=0,g=0,x=!1,l=0;i>l;l=l+1|0)if(!x)for(p=0;u>p;p=p+1|0)x||(w=p+u*l,y=h+p+f*(s+l),v+=a(b[y]-M[w]),g=v/_,g>n&&(x=!0));n>=g&&(n=g,console.log("normal ",g,v,_),m={normalize:g,similar:v,x:h,y:s,width:u,height:i})}return console.log("------------------------- ",(Date.now()-B)/1e3),m},t}()}(window),function(t){"use strict";function r(t){return 65280&t}function e(t){return 255&t}function a(t){return s[(65280&t)>>8]}var n=t.Igata,o=n,f=o.U8_t,i=o.S32_t,u=o.F32_t,s=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8]);o.dataType=r,o.get_data_type=r,o.channel=e,o.get_channel=e,o.dataTypeSize=a,o.get_data_type_size=a;var c=function(){function t(t,r){this.size=-8&(t+7|0),"undefined"==typeof r?this.buffer=new ArrayBuffer(this.size):(this.buffer=r,this.size=r.length),this.u8=new Uint8Array(this.buffer),this.i32=new Int32Array(this.buffer),this.f32=new Float32Array(this.buffer),this.f64=new Float64Array(this.buffer)}var r=t.prototype;return r.constructor=t,t}(),h=function(){function t(t,a,n,o){this.type=0|r(n),this.channel=0|e(n),this.cols=0|t,this.rows=0|a,"undefined"==typeof o?this.allocate():(this.buffer=o,this.data=this.type&f?this.buffer.u8:this.type&i?this.buffer.i32:this.type&u?this.buffer.f32:this.buffer.f64)}var n=t.prototype;return n.constructor=t,n.allocate=function(){delete this.data,delete this.buffer,this.buffer=new c(this.cols*a(this.type)*this.channel*this.rows),this.data=this.type&f?this.buffer.u8:this.type&i?this.buffer.i32:this.type&u?this.buffer.f32:this.buffer.f64},n.copy=function(t){for(var r=t.data,e=this.data,a=0,n=this.cols*this.rows*this.channel|0,o=n-4;o>a;a+=4)r[a]=e[a],r[a+1]=e[a+1],r[a+2]=e[a+2],r[a+3]=e[a+3];for(;n>a;++a)r[a]=e[a]},n.copy_to=function(t){this.copy(t)},n.resize=function(t,r,e){"undefined"==typeof e&&(e=this.channel);var n=t*a(this.type)*e*r;n>this.buffer.size?(this.cols=t,this.rows=r,this.channel=e,this.allocate()):(this.cols=t,this.rows=r,this.channel=e)},t}(),d=function(){function t(t,r,e,a,n){"undefined"==typeof t&&(t=0),"undefined"==typeof r&&(r=0),"undefined"==typeof e&&(e=0),"undefined"==typeof a&&(a=0),"undefined"==typeof n&&(n=-1),this.x=t,this.y=r,this.score=e,this.level=a,this.angle=n}var r=t.prototype;return r.constructor=t,t}();o.Data_t=c,o.Matrix_t=h,o.Keypoint_t=d}(window),function(t){"use strict";var r=t.Igata,e=r,a=e.Data_t,n=function(){function t(t){this.next=null;var r=new a(t);this.data=r,this.size=r.size,this.buffer=r.buffer,this.u8=r.u8,this.i32=r.i32,this.f32=r.f32,this.f64=r.f64}var r=t.prototype;return r.constructor=t,r.resize=function(t){delete this.data;var r=new a(t);this.data=r,this.size=r.size,this.buffer=r.buffer,this.u8=r.u8,this.i32=r.i32,this.f32=r.f32,this.f64=r.f64},t}(),o=function(){function t(){throw new Error("Cache can't create instance.")}var r,e,a=0,o=t.prototype;return o.constructor=t,t.allocate=function(t,o){var f,i;for(r=e=new n(o),i=0;t>i;++i)f=new n(o),e=e.next=f,a++},t.getBuffer=function(t){var e=r;return r=r.next,a--,t>e.size&&e.resize(t),e},t.get_buffer=function(r){return t.getBuffer(r)},t.putBuffer=function(t){e=e.next=t,a++},t.put_buffer=function(r){t.putBuffer(r)},t}();o.allocate(30,2560),e.Cache=o}(window),function(t){"use strict";var r=t.Igata,e=r,a=function(){function t(){throw new Error("Calc can't create instance.")}var r=new Int32Array(96),a=e.Cache,n=e.U8_t,o=(e.S32_t,e.F32_t,e.S64_t,e.F64_t,t.prototype);return o.constructor=t,t.kernel=function(t,r,e,o){var f=0,i=0,u=0,s=0,c=0,h=0,d=a.getBuffer(t<<2),l=d.f32;if(1===(1&t)&&7>=t&&0>=r)switch(t>>1){case 0:l[0]=1,h=1;break;case 1:l[0]=.25,l[1]=.5,l[2]=.25,h=1;break;case 2:l[0]=.0625,l[1]=.25,l[2]=.375,l[3]=.25,l[4]=.0625,h=1;break;case 3:l[0]=.03125,l[1]=.109375,l[2]=.21875,l[3]=.28125,l[4]=.21875,l[5]=.109375,l[6]=.03125,h=1}else for(s=r>0?r:.3*(.5*(t-1)-1)+.8,c=-.5/(s*s);t>f;++f)i=f-.5*(t-1),u=Math.exp(c*i*i),l[f]=u,h+=u;if(o&n)for(h=256/h,f=0;t>f;++f)e[f]=l[f]*h+.5|0;else for(h=1/h,f=0;t>f;++f)e[f]=l[f]*h;a.putBuffer(d)},t.get_gaussian_kernel=function(r,e,a,n){t.kernel(r,e,a,n)},t.perspective4=function(t,r,e,a,n,o,f,i,u,s,c,h,d,l,p,v,g){var y=r,w=s,x=f,m=y*w*x,_=p,b=y*_,M=w*b,B=c,k=y*B,I=o,z=e,A=l,C=z*A,D=C*I,S=A*I*B,O=A*x,R=A*B,q=w*x,F=_*w,L=_*I,E=B*I,T=1/(O-R-q+F-L+E),U=y*A,G=z*I,P=x*y,N=_*P,V=z*w,Y=C*B,j=z*B*I,H=x*_*w,Q=_*z,X=-(M-m+k*I-I*b-C*w+D-S+O*w)*T,K=(m-M-U*x+U*B+D-w*G+L*w-S)*T,J=y,W=(-B*b+N+V*x-C*x+Y-j+L*B-H)*T,Z=(-N+P*B-Q*w+Y-j+Q*I+H-O*B)*T,$=z,tt=(-k+P+V-G+R-O-F+L)*T,rt=(-b+k+C-V+L-E-O+q)*T;y=a,w=h,x=u,m=y*w*x,_=g,b=y*_,M=w*b,B=d,k=y*B,I=i,z=n,A=v,C=z*A,D=C*I,S=A*I*B,O=A*x,R=A*B,q=w*x,F=_*w,L=_*I,E=B*I,T=1/(O-R-q+F-L+E),U=y*A,G=z*I,P=x*y,N=_*P,V=z*w,Y=C*B,j=z*B*I,H=x*_*w,Q=_*z;var et=-(M-m+k*I-I*b-C*w+D-S+O*w)*T,at=(m-M-U*x+U*B+D-w*G+L*w-S)*T,nt=y,ot=(-B*b+N+V*x-C*x+Y-j+L*B-H)*T,ft=(-N+P*B-Q*w+Y-j+Q*I+H-O*B)*T,it=z,ut=(-k+P+V-G+R-O-F+L)*T,st=(-b+k+C-V+L-E-O+q)*T;w=Z-rt*$,x=X*Z,m=X*$,b=W*K,M=J*W,k=K*tt;var ct=J*tt;A=1/(x-m*rt-b+M*rt+k*$-ct*Z),D=-W+$*tt;var ht=-W*rt+Z*tt;E=-K+J*rt;var dt=X-ct;G=X*rt-k,P=-K*$+J*Z;var lt=m-M,pt=x-b;j=w*A;var vt=E*A,gt=P*A,yt=t.data;yt[0]=et*j+at*(D*A)-nt*(ht*A),yt[1]=et*vt+at*(dt*A)-nt*(G*A),yt[2]=-et*gt-at*(lt*A)+nt*(pt*A),yt[3]=ot*j+ft*(D*A)-it*(ht*A),yt[4]=ot*vt+ft*(dt*A)-it*(G*A),yt[5]=-ot*gt-ft*(lt*A)+it*(pt*A),yt[6]=ut*j+st*(D*A)-ht*A,yt[7]=ut*vt+st*(dt*A)-G*A,yt[8]=-ut*gt-st*(lt*A)+pt*A},t.perspective_4point_transform=function(r,e,a,n,o,f,i,u,s,c,h,d,l,p,v,g,y){t.perspective4(r,e,a,n,o,f,i,u,s,c,h,d,l,p,v,g,y)},t.qsort=function(t,e,a,n){var o,f,i,u,s=7,c=0,h=0,d=0,l=0,p=0,v=0,g=0,y=0,w=0,x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=0,z=0,A=r;if(!(1>=a-e+1))for(A[0]=e,A[1]=a;c>=0;)for(h=A[c<<1],d=A[(c<<1)+1],c--;;){if(p=d-h+1,s>=p){for(g=h+1;d>=g;g++)for(y=g;y>h&&n(t[y],t[y-1]);y--)o=t[y],t[y]=t[y-1],t[y-1]=o;break}for(z=0,x=h,_=d,M=h+(p>>1),p>40&&(w=p>>3,B=h,k=h+w,I=h+(w<<1),f=t[B],i=t[k],u=t[I],h=n(f,i)?n(i,u)?k:n(f,u)?I:B:n(u,i)?k:n(f,u)?B:I,B=M-w,k=M,I=M+w,f=t[B],i=t[k],u=t[I],M=n(f,i)?n(i,u)?k:n(f,u)?I:B:n(u,i)?k:n(f,u)?B:I,B=d-(w<<1),k=d-w,I=d,f=t[B],i=t[k],u=t[I],d=n(f,i)?n(i,u)?k:n(f,u)?I:B:n(u,i)?k:n(f,u)?B:I),B=h,k=M,I=d,f=t[B],i=t[k],u=t[I],M=n(f,i)?n(i,u)?k:n(f,u)?I:B:n(u,i)?k:n(f,u)?B:I,M!==x&&(o=t[M],t[M]=t[x],t[x]=o,M=x),h=m=x+1,d=b=_,f=t[M];;){for(;d>=h&&!n(f,t[h]);)n(t[h],f)||(h>m&&(o=t[m],t[m]=t[h],t[h]=o),z=1,m++),h++;for(;d>=h&&!n(t[d],f);)n(f,t[d])||(b>d&&(o=t[b],t[b]=t[d],t[d]=o),z=1,b--),d--;if(h>d)break;o=t[h],t[h]=t[d],t[d]=o,z=1,h++,d--}if(0===z){for(h=x,d=_,g=h+1;d>=g;g++)for(y=g;y>h&&n(t[y],t[y-1]);y--)o=t[y],t[y]=t[y-1],t[y-1]=o;break}for(p=Math.min(m-x,h-m),v=h-p|0,l=0;p>l;++l,++v)o=t[x+l],t[x+l]=t[v],t[v]=o;for(p=Math.min(_-b,b-d),v=_-p+1|0,l=0;p>l;++l,++v)o=t[h+l],t[h+l]=t[v],t[v]=o;if(p=h-m,v=b-d,p>1)v>1?p>v?(++c,A[c<<1]=x,A[(c<<1)+1]=x+p-1,h=_-v+1,d=_):(++c,A[c<<1]=_-v+1,A[(c<<1)+1]=_,h=x,d=x+p-1):(h=x,d=x+p-1);else{if(!(v>1))break;h=_-v+1,d=_}}},t.median=function(t,r,e){for(var a,n=0,o=0,f=0,i=r+e>>1;;){if(r>=e)return t[i];if(e===r+1)return t[r]>t[e]&&(a=t[r],t[r]=t[e],t[e]=a),t[i];for(n=r+e>>1,t[n]>t[e]&&(a=t[n],t[n]=t[e],t[e]=a),t[r]>t[e]&&(a=t[r],t[r]=t[e],t[e]=a),t[n]>t[r]&&(a=t[n],t[n]=t[r],t[r]=a),o=r+1,a=t[n],t[n]=t[o],t[o]=a,f=e;;){do++o;while(t[r]>t[o]);do--f;while(t[f]>t[r]);if(o>f)break;a=t[o],t[o]=t[f],t[f]=a}a=t[r],t[r]=t[f],t[f]=a,i>=f?r=o:f>=i&&(e=f-1)}return 0},t}();e.Calc=a}(window),function(t){"use strict";var r=t.Igata,e=r,a=function(){function t(){throw new Error("MatrixMath can't create instance.")}var r=t.prototype;return r.constructor=t,t.identity=function(t,r){"undefined"==typeof r&&(r=1);for(var e=t.data,a=t.rows,n=t.cols,o=n+1|0,f=a*n,i=f;--f>=0;)e[f]=0;for(f=i,i=0;f>i;)e[i]=r,i+=o},t.transpose=function(t,r){for(var e=0,a=0,n=r.rows,o=r.cols,f=0,i=0,u=0,s=r.data,c=t.data;n>e;i+=1,f+=o,e++)for(u=i,a=0;o>a;u+=n,a++)c[u]=s[f+a]},t.multiply=function(t,r,e){for(var a=0,n=0,o=0,f=0,i=0,u=0,s=0,c=0,h=r.cols,d=r.rows,l=e.cols,p=r.data,v=e.data,g=t.data,y=0;d>a;f+=h,a++)for(s=0,n=0;l>n;c++,s++,n++){for(u=s,i=f,y=0,o=0;h>o;i++,u+=l,o++)y+=p[i]*v[u];g[c]=y}},t.multiply_ABt=function(t,r,e){for(var a=0,n=0,o=0,f=0,i=0,u=0,s=0,c=r.cols,h=r.rows,d=e.rows,l=r.data,p=e.data,v=t.data,g=0;h>a;f+=c,a++)for(u=0,n=0;d>n;s++,n++){for(i=f,g=0,o=0;c>o;i++,u++,o++)g+=l[i]*p[u];v[s]=g}},t.multiply_AtB=function(t,r,e){for(var a=0,n=0,o=0,f=0,i=0,u=0,s=0,c=0,h=r.cols,d=r.rows,l=e.cols,p=r.data,v=e.data,g=t.data,y=0;h>a;f++,a++)for(s=0,n=0;l>n;c++,s++,n++){for(u=s,i=f,y=0,o=0;d>o;i+=h,u+=l,o++)y+=p[i]*v[u];g[c]=y}},t.multiply_AAt=function(t,r){for(var e=0,a=0,n=0,o=0,f=0,i=0,u=0,s=0,c=0,h=r.cols,d=r.rows,l=r.data,p=t.data,v=0;d>e;o+=d+1,f=i,e++)for(s=o,c=o,u=f,a=e;d>a;s++,c+=d,a++){for(i=f,v=0,n=0;h>n;n++)v+=l[i++]*l[u++];p[s]=v,p[c]=v}},t.multiply_AtA=function(t,r){for(var e=0,a=0,n=0,o=0,f=0,i=0,u=0,s=0,c=0,h=r.cols,d=r.rows,l=r.data,p=t.data,v=0;h>e;u+=h,e++)for(o=e,c=u+e,s=c,a=e;h>a;s++,c+=h,a++){for(f=o,i=a,v=0,n=0;d>n;f+=h,i+=h,n++)v+=l[f]*l[i];p[s]=v,p[c]=v}},t.identity_3x3=function(t,r){"undefined"==typeof r&&(r=1);var e=t.data;e[0]=e[4]=e[8]=r,e[1]=e[2]=e[3]=0,e[5]=e[6]=e[7]=0},t.invert_3x3=function(t,r){var e=t.data,a=r.data,n=e[4],o=e[8],f=e[5],i=e[7],u=e[0],s=u*n,c=u*f,h=e[3],d=e[1],l=h*d,p=e[2],v=h*p,g=e[6],y=g*d,w=g*p,x=1/(s*o-c*i-l*o+v*i+y*f-w*n);a[0]=(n*o-f*i)*x,a[1]=-(d*o-p*i)*x,a[2]=-(-d*f+p*n)*x,a[3]=-(h*o-f*g)*x,a[4]=(u*o-w)*x,a[5]=-(c-v)*x,a[6]=-(-h*i+n*g)*x,a[7]=-(u*i-y)*x,a[8]=(s-l)*x},t.multiply_3x3=function(t,r,e){var a=t.data,n=r.data,o=e.data,f=n[0],i=n[1],u=n[2],s=n[3],c=n[4],h=n[5],d=n[6],l=n[7],p=n[8],v=o[0],g=o[1],y=o[2],w=o[3],x=o[4],m=o[5],_=o[6],b=o[7],M=o[8];a[0]=f*v+i*w+u*_,a[1]=f*g+i*x+u*b,a[2]=f*y+i*m+u*M,a[3]=s*v+c*w+h*_,a[4]=s*g+c*x+h*b,a[5]=s*y+c*m+h*M,a[6]=d*v+l*w+p*_,a[7]=d*g+l*x+p*b,a[8]=d*y+l*m+p*M},t.mat3x3_determinant=function(t){var r=t.data;return r[0]*r[4]*r[8]-r[0]*r[5]*r[7]-r[3]*r[1]*r[8]+r[3]*r[2]*r[7]+r[6]*r[1]*r[5]-r[6]*r[2]*r[4]},t.determinant_3x3=function(t,r,e,a,n,o,f,i,u){return t*n*u-t*o*i-a*r*u+a*e*i+f*r*o-f*e*n},t}();e.MatrixMath=a,e.MM=a}(window),function(t){"use strict";function r(t,r,e,a){a=t[r],t[r]=t[e],t[e]=a}function e(t,r){return t=Math.abs(t),r=Math.abs(r),t>r?(r/=t,t*Math.sqrt(1+r*r)):r>0?(t/=r,r*Math.sqrt(1+t*t)):0}function a(t,a,n,f,u,s){var c=o.EPSILON,h=0,d=0,l=0,p=0,v=0,g=0,y=0,w=0,x=0,m=s*s*30,_=0,b=0,M=0,B=0,k=0,I=0,z=0,A=0,C=0,D=i.getBuffer(s<<2),S=i.getBuffer(s<<2),O=D.i32,R=S.i32;if(f)for(;s>h;h++){for(l=h*u,d=0;s>d;d++)f[l+d]=0;f[l+h]=1}for(l=0;s>l;l++){if(n[l]=t[(a+1)*l],s-1>l){for(p=l+1,_=Math.abs(t[a*l+p]),h=l+2;s>h;h++)b=Math.abs(t[a*l+h]),b>_&&(_=b,p=h);O[l]=p}if(l>0){for(p=0,_=Math.abs(t[l]),h=1;l>h;h++)b=Math.abs(t[a*h+l]),b>_&&(_=b,p=h);R[l]=p}}if(s>1)for(;m>x;x++){for(l=0,_=Math.abs(t[O[0]]),h=1;s-1>h;h++)b=Math.abs(t[a*h+O[h]]),b>_&&(_=b,l=h);for(v=O[l],h=1;s>h;h++)b=Math.abs(t[a*R[h]+h]),b>_&&(_=b,l=R[h],v=h);if(M=t[a*l+v],Math.abs(M)<=c)break;for(B=.5*(n[v]-n[l]),k=Math.abs(B)+e(M,B),I=e(M,k),z=k/I,I=M/I,k=M/k*M,0>B&&(I=-I,k=-k),t[a*l+v]=0,n[l]-=k,n[v]+=k,h=0;l>h;h++)y=a*h+l,w=a*h+v,A=t[y],C=t[w],t[y]=A*z-C*I,t[w]=A*I+C*z;for(h=l+1;v>h;h++)y=a*l+h,w=a*h+v,A=t[y],C=t[w],t[y]=A*z-C*I,t[w]=A*I+C*z;for(h=v+1,y=a*l+h,w=a*v+h;s>h;h++,y++,w++)A=t[y],C=t[w],t[y]=A*z-C*I,t[w]=A*I+C*z;if(f)for(y=u*l,w=u*v,h=0;s>h;h++,y++,w++)A=f[y],C=f[w],f[y]=A*z-C*I,f[w]=A*I+C*z;for(d=0;2>d;d++){if(g=0===d?l:v,s-1>g){for(p=g+1,_=Math.abs(t[a*g+p]),h=g+2;s>h;h++)b=Math.abs(t[a*g+h]),b>_&&(_=b,p=h);O[g]=p}if(g>0){for(p=0,_=Math.abs(t[g]),h=1;g>h;h++)b=Math.abs(t[a*h+g]),b>_&&(_=b,p=h);R[g]=p}}}for(l=0;s-1>l;l++){for(p=l,h=l+1;s>h;h++)n[p]<n[h]&&(p=h);if(l!==p&&(r(n,p,l,_),f))for(h=0;s>h;h++)r(f,u*p+h,u*l+h,_)}i.putBuffer(D),i.putBuffer(S)}function n(t,a,n,f,u,s,c,h){for(var d=2*o.EPSILON,l=o.FLT_MIN,p=0,v=0,g=0,y=0,w=Math.max(s,30),x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=0,z=0,A=0,C=0,D=0,S=0,O=0,R=0,q=0,F=0,L=4660,E=0,T=0,U=0,G=i.getBuffer(c<<3),P=G.f64;c>p;p++){for(g=0,C=0;s>g;g++)I=t[p*a+g],C+=I*I;if(P[p]=C,f){for(g=0;c>g;g++)f[p*u+g]=0;f[p*u+p]=1}}for(;w>y;y++){for(M=0,p=0;c-1>p;p++)for(v=p+1;c>v;v++){for(x=p*a|0,m=v*a|0,R=P[p],q=0,F=P[v],g=2,q+=t[x]*t[m],q+=t[x+1]*t[m+1];s>g;g++)q+=t[x+g]*t[m+g];if(!(Math.abs(q)<=d*Math.sqrt(R*F))){for(q*=2,D=R-F,S=e(q,D),0>D?(O=.5*(S-D),k=Math.sqrt(O/S),B=q/(S*k*2)):(B=Math.sqrt((S+D)/(2*S)),k=q/(S*B*2)),R=0,F=0,g=2,z=B*t[x]+k*t[m],A=-k*t[x]+B*t[m],t[x]=z,t[m]=A,R+=z*z,F+=A*A,z=B*t[x+1]+k*t[m+1],A=-k*t[x+1]+B*t[m+1],t[x+1]=z,t[m+1]=A,R+=z*z,F+=A*A;s>g;g++)z=B*t[x+g]+k*t[m+g],A=-k*t[x+g]+B*t[m+g],t[x+g]=z,t[m+g]=A,R+=z*z,F+=A*A;if(P[p]=R,P[v]=F,M=1,f)for(_=p*u|0,b=v*u|0,g=2,z=B*f[_]+k*f[b],A=-k*f[_]+B*f[b],f[_]=z,f[b]=A,z=B*f[_+1]+k*f[b+1],A=-k*f[_+1]+B*f[b+1],f[_+1]=z,f[b+1]=A;c>g;g++)z=B*f[_+g]+k*f[b+g],A=-k*f[_+g]+B*f[b+g],f[_+g]=z,f[b+g]=A}}if(0===M)break}for(p=0;c>p;p++){for(g=0,C=0;s>g;g++)I=t[p*a+g],C+=I*I;P[p]=Math.sqrt(C)}for(p=0;c-1>p;p++){for(v=p,g=p+1;c>g;g++)P[v]<P[g]&&(v=g);if(p!==v&&(r(P,p,v,C),f)){for(g=0;s>g;g++)r(t,p*a+g,v*a+g,I);for(g=0;c>g;g++)r(f,p*u+g,v*u+g,I)}}for(p=0;c>p;p++)n[p]=P[p];if(!f)return void i.putBuffer(G);for(p=0;h>p;p++){for(C=c>p?P[p]:0;l>=C;){for(T=1/s,g=0;s>g;g++)L=214013*L+2531011,E=0!==(L>>16&32767&256)?T:-T,t[p*a+g]=E;for(y=0;2>y;y++)for(v=0;p>v;v++){for(C=0,g=0;s>g;g++)C+=t[p*a+g]*t[v*a+g];for(U=0,g=0;s>g;g++)I=t[p*a+g]-C*t[v*a+g],t[p*a+g]=I,U+=Math.abs(I);for(U=U?1/U:0,g=0;s>g;g++)t[p*a+g]*=U}for(C=0,g=0;s>g;g++)I=t[p*a+g],C+=I*I;C=Math.sqrt(C)}for(k=1/C,g=0;s>g;g++)t[p*a+g]*=k}i.putBuffer(G)}var o=t.Igata,f=o,i=f.Cache,u=f.Matrix_t,s=f.MM,c=function(){function t(){throw new Error("LinearAlgebra can't create instance.")}var e=t.prototype;return e.constructor=t,t.lu_solve=function(t,e){var a,n,f,i,u=0,s=0,c=0,h=1,d=t.cols,l=t.data,p=e.data;for(u=0;d>u;u++){for(c=u,s=u+1;d>s;s++)Math.abs(l[s*d+u])>Math.abs(l[c*d+u])&&(c=s);if(Math.abs(l[c*d+u])<o.EPSILON)return 0;if(c!==u){for(s=u;d>s;s++)r(l,u*d+s,c*d+s,a);r(p,u,c,a),h=-h}for(f=-1/l[u*d+u],s=u+1;d>s;s++){for(n=l[s*d+u]*f,c=u+1;d>c;c++)l[s*d+c]+=n*l[u*d+c];p[s]+=n*p[u]}l[u*d+u]=-f}for(u=d-1;u>=0;u--){for(i=p[u],c=u+1;d>c;c++)i-=l[u*d+c]*p[c];p[u]=i*l[u*d+u]}return 1},t.cholesky_solve=function(t,r){var e,a,n=0,o=0,f=0,i=0,u=0,s=0,c=0,h=t.cols,d=t.data,l=r.data;for(n=0;h>n;n++)for(a=1,i=n*h,u=i,o=n;h>o;o++){for(e=d[u+n],f=0;n>f;f++)e-=d[f*h+n]*d[u+f];if(o===n){if(d[u+n]=e,0===e)return 0;a=1/e}else d[i+o]=e,d[u+n]=e*a;u+=h}for(i=0,s=0;h>s;s++){for(e=l[s],c=0;s>c;c++)e-=d[i+c]*l[c];l[s]=e,i+=h}for(i=0,s=0;h>s;s++)l[s]/=d[i+s],i+=h;for(s=h-1;s>=0;s--){for(e=l[s],c=s+1,i=c*h;h>c;c++)e-=d[i+s]*l[c],i+=h;l[s]=e}return 1},t.svd_decompose=function(t,r,e,a,f){"undefined"==typeof f&&(f=0);var c=0,h=0,d=t.rows,l=t.cols,p=d,v=l,g=t.type|o.C1_t;v>p&&(c=1,h=p,p=v,v=h);var y=i.getBuffer(p*p<<3),w=i.getBuffer(v<<3),x=i.getBuffer(v*v<<3),m=new u(p,p,g,y.data),_=new u(1,v,g,w.data),b=new u(v,v,g,x.data);if(0===c)s.transpose(m,t);else{for(h=0;l*d>h;h++)m.data[h]=t.data[h];for(;v*p>h;h++)m.data[h]=0}if(n(m.data,p,_.data,b.data,v,p,v,p),r){for(h=0;v>h;h++)r.data[h]=_.data[h];for(;l>h;h++)r.data[h]=0}if(0===c){if(e&&f&o.SVD_U_T)for(h=p*p;--h>=0;)e.data[h]=m.data[h];else e&&s.transpose(e,m);if(a&&f&o.SVD_V_T)for(h=v*v;--h>=0;)a.data[h]=b.data[h];else a&&s.transpose(a,b)}else{if(e&&f&o.SVD_U_T)for(h=v*v;--h>=0;)e.data[h]=b.data[h];else e&&s.transpose(e,b);if(a&&f&o.SVD_V_T)for(h=p*p;--h>=0;)a.data[h]=m.data[h];else a&&s.transpose(a,m)}i.putBuffer(y),i.putBuffer(w),i.putBuffer(x)},t.svd_solve=function(r,e,a){var n=0,f=0,s=0,c=0,h=0,d=r.rows,l=r.cols,p=0,v=0,g=0,y=r.type|o.C1_t,w=i.getBuffer(d*d<<3),x=i.getBuffer(l<<3),m=i.getBuffer(l*l<<3),_=new u(d,d,y,w.data),b=new u(1,l,y,x.data),M=new u(l,l,y,m.data),B=a.data,k=_.data,I=b.data,z=M.data;for(t.svd_decompose(r,b,_,M,0),g=o.EPSILON*I[0]*l;l>n;n++,h+=l){for(v=0,f=0;l>f;f++)if(I[f]>g){for(s=0,p=0,c=0;d>s;s++,c+=l)p+=k[c+f]*B[s];v+=p*z[h+f]/I[f]}e.data[n]=v}i.putBuffer(w),i.putBuffer(x),i.putBuffer(m)},t.svd_invert=function(r,e){var a=0,n=0,f=0,s=0,c=0,h=0,d=e.rows,l=e.cols,p=0,v=0,g=e.type|o.C1_t,y=i.getBuffer(d*d<<3),w=i.getBuffer(l<<3),x=i.getBuffer(l*l<<3),m=new u(d,d,g,y.data),_=new u(1,l,g,w.data),b=new u(l,l,g,x.data),M=r.data,B=m.data,k=_.data,I=b.data;for(t.svd_decompose(e,_,m,b,0),v=o.EPSILON*k[0]*l;l>a;a++,c+=l)for(n=0,s=0;d>n;n++,h++){for(f=0,p=0;l>f;f++,s++)k[f]>v&&(p+=I[c+f]*B[s]/k[f]);M[h]=p}i.putBuffer(y),i.putBuffer(w),i.putBuffer(x)},t.eigenVV=function(t,r,e){for(var n=t.cols,f=n*n,s=t.type|o.C1_t,c=i.getBuffer(n*n<<3),h=i.getBuffer(n<<3),d=new u(n,n,s,c.data),l=new u(1,n,s,h.data);--f>=0;)d.data[f]=t.data[f];if(a(d.data,n,l.data,r?r.data:null,n,n),e)for(;--n>=0;)e.data[n]=l.data[n];i.putBuffer(c),i.putBuffer(h)},t}();f.LinearAlgebra=c,f.LA=c}(window),function(t){"use strict";var r=t.Igata,e=r,a=e.Cache,n=e.Matrix_t,o=e.MM,f=e.LA,i=e.Calc,u=e.F32_t,s=e.C1_t,c=e.EPSILON,h=new n(3,3,u|s),d=new n(3,3,u|s),l=new n(6,6,u|s),p=new n(6,1,u|s),v=new n(9,9,u|s),g=new n(9,9,u|s),y=function(){function t(t,r,e,a,n){for(var o=0,f=0,i=0,u=0,s=0,c=0,h=0,d=0,l=0,p=0,v=0;n>o;++o)f+=t[o].x,i+=t[o].y,c+=r[o].x,h+=r[o].y;for(f/=n,i/=n,c/=n,h/=n,o=0;n>o;++o)p=t[o].x-f,v=t[o].y-i,u+=Math.sqrt(p*p+v*v),p=r[o].x-c,v=r[o].y-h,d+=Math.sqrt(p*p+v*v);u/=n,d/=n,s=Math.SQRT2/u,l=Math.SQRT2/d,e[0]=e[4]=s,e[2]=-f*s,e[5]=-i*s,e[1]=e[3]=e[6]=e[7]=0,e[8]=1,a[0]=a[4]=l,a[2]=-c*l,a[5]=-h*l,a[1]=a[3]=a[6]=a[7]=0,a[8]=1}function r(){}var e=r.prototype;return e.constructor=r,e.run=function(r,e,i,u){var c,v,g=0,y=0,w=i.type|s,x=i.data,m=h.data,_=d.data,b=0,M=0;t(r,e,m,_,u);for(var B=a.getBuffer(2*u*6<<3),k=a.getBuffer(2*u<<3),I=new n(6,2*u,w,B.data),z=new n(1,2*u,w,k.data),A=I.data,C=z.data;u>g;++g)c=r[g],v=e[g],b=m[0]*c.x+m[1]*c.y+m[2],M=m[3]*c.x+m[4]*c.y+m[5],y=2*g*6,A[y]=b,A[y+1]=M,A[y+2]=1,A[y+3]=0,A[y+4]=0,A[y+5]=0,y+=6,A[y]=0,A[y+1]=0,A[y+2]=0,A[y+3]=b,A[y+4]=M,A[y+5]=1,C[g<<1]=_[0]*v.x+_[1]*v.y+_[2],C[(g<<1)+1]=_[3]*v.x+_[4]*v.y+_[5];return o.multiply_AtA(l,I),o.multiply_AtB(p,I,z),f.lu_solve(l,p),x[0]=p.data[0],x[1]=p.data[1],x[2]=p.data[2],x[3]=p.data[3],x[4]=p.data[4],x[5]=p.data[5],x[6]=0,x[7]=0,x[8]=1,o.invert_3x3(d,d),o.multiply_3x3(i,d,i),o.multiply_3x3(i,i,h),a.putBuffer(B),a.putBuffer(k),1},r}(),w=function(){function t(){}var r=t.prototype;return r.constructor=t,r.run=function(t,r,e,a){for(var n=0,i=0,u=e.data,s=h.data,l=d.data,p=v.data,y=g.data,w=0,x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=0,z=0,A=0,C=0;a>n;++n)B+=r[n].x,k+=r[n].y,A+=t[n].x,C+=t[n].y;for(B/=a,k/=a,A/=a,C/=a,n=0;a>n;++n)b+=Math.abs(r[n].x-B),M+=Math.abs(r[n].y-k),I+=Math.abs(t[n].x-A),z+=Math.abs(t[n].y-C);if(Math.abs(b)<c||Math.abs(M)<c||Math.abs(I)<c||Math.abs(z)<c)return 0;for(b=a/b,M=a/M,I=a/I,z=a/z,s[0]=I,s[1]=0,s[2]=-A*I,s[3]=0,s[4]=z,s[5]=-C*z,s[6]=0,s[7]=0,s[8]=1,l[0]=1/b,l[1]=0,l[2]=B,l[3]=0,l[4]=1/M,l[5]=k,l[6]=0,l[7]=0,l[8]=1,n=81;--n>=0;)p[n]=0;for(n=0;a>n;++n)w=(r[n].x-B)*b,x=(r[n].y-k)*M,m=(t[n].x-A)*I,_=(t[n].y-C)*z,p[0]+=m*m,p[1]+=m*_,p[2]+=m,p[6]+=m*-w*m,p[7]+=m*-w*_,p[8]+=m*-w,p[10]+=_*_,p[11]+=_,p[15]+=_*-w*m,p[16]+=_*-w*_,p[17]+=_*-w,p[20]+=1,p[24]+=-w*m,p[25]+=-w*_,p[26]+=-w,p[30]+=m*m,p[31]+=m*_,p[32]+=m,p[33]+=m*-x*m,p[34]+=m*-x*_,p[35]+=m*-x,p[40]+=_*_,p[41]+=_,p[42]+=_*-x*m,p[43]+=_*-x*_,p[44]+=_*-x,p[50]+=1,p[51]+=-x*m,p[52]+=-x*_,p[53]+=-x,p[60]+=-w*m*-w*m+-x*m*-x*m,p[61]+=-w*m*-w*_+-x*m*-x*_,p[62]+=-w*m*-w+-x*m*-x,p[70]+=-w*_*-w*_+-x*_*-x*_,p[71]+=-w*_*-w+-x*_*-x,p[80]+=-w*-w+-x*-x;for(n=0;9>n;++n)for(i=0;n>i;++i)p[9*n+i]=p[9*i+n];return f.eigenVV(v,g),u[0]=y[72],u[1]=y[73],u[2]=y[74],u[3]=y[75],u[4]=y[76],u[5]=y[77],u[6]=y[78],u[7]=y[79],u[8]=y[80],o.multiply_3x3(e,d,e),o.multiply_3x3(e,e,h),w=1/u[8],u[0]*=w,u[1]*=w,u[2]*=w,u[3]*=w,u[4]*=w,u[5]*=w,u[6]*=w,u[7]*=w,u[8]=1,1},r.error=function(t,r,e,a,n){for(var o,f,i=0,u=0,s=0,c=0,h=e.data;n>i;++i)o=t[i],f=r[i],u=1/(h[6]*o.x+h[7]*o.y+1),s=(h[0]*o.x+h[1]*o.y+h[2])*u-f.x,c=(h[3]*o.x+h[4]*o.y+h[5])*u-f.y,a[i]=s*s+c*c;
},r.checkSubset=function(t,r,e){if(4===e){var a=0,n=t[0],f=t[1],i=t[2],u=t[3],s=r[0],c=r[1],h=r[2],d=r[3],l=n.x,p=n.y,v=1,g=f.x,y=f.y,w=1,x=i.x,m=i.y,_=1,b=s.x,M=s.y,B=1,k=c.x,I=c.y,z=1,A=h.x,C=h.y,D=1,S=o.determinant_3x3(l,p,v,g,y,w,x,m,_),O=o.determinant_3x3(b,M,B,k,I,z,A,C,D);if(0>S*O&&a++,l=f.x,p=f.y,g=i.x,y=i.y,x=u.x,m=u.y,b=c.x,M=c.y,k=h.x,I=h.y,A=d.x,C=d.y,S=o.determinant_3x3(l,p,v,g,y,w,x,m,_),O=o.determinant_3x3(b,M,B,k,I,z,A,C,D),0>S*O&&a++,l=n.x,p=n.y,g=i.x,y=i.y,x=u.x,m=u.y,b=s.x,M=s.y,k=h.x,I=h.y,A=d.x,C=d.y,S=o.determinant_3x3(l,p,v,g,y,w,x,m,_),O=o.determinant_3x3(b,M,B,k,I,z,A,C,D),0>S*O&&a++,l=n.x,p=n.y,g=f.x,y=f.y,x=u.x,m=u.y,b=s.x,M=s.y,k=c.x,I=c.y,A=d.x,C=d.y,S=o.determinant_3x3(l,p,v,g,y,w,x,m,_),O=o.determinant_3x3(b,M,B,k,I,z,A,C,D),0>S*O&&a++,0!==a&&-4!==a)return!1}return!0},r.check_subset=function(t,r,e){this.checkSubset(t,r,e)},t}(),x=function(){function t(t,r,e,a){"undefined"==typeof t&&(t=0),"undefined"==typeof r&&(r=.5),"undefined"==typeof e&&(e=.5),"undefined"==typeof a&&(a=.99),this.size=t,this.thresh=r,this.eps=e,this.prob=a}var r=t.prototype;return r.constructor=t,r.update=function(t,r){var e=Math.log(1-this.prob),a=Math.log(1-Math.pow(1-t,this.size));return 0|(a>=0||-e>=r*-a?r:Math.round(e/a))},r.update_iters=function(t,r){return this.update(t,r)},t}(),m=function(){function t(t,r,e,a,n,o,f){for(var i=1e3,u=[],s=0,c=0,h=0,d=0,l=!1;i>h;++h){for(s=0;a>s&&i>h;){for(l=!1,d=0;!l;)for(l=!0,d=u[s]=0|Math.floor(Math.random()*n),c=0;s>c;++c)if(d===u[c]){l=!1;break}o[s]=r[d],f[s]=e[d],t.check_subset(o,f,s+1)?++s:h++}break}return s===a&&i>h}function e(t,r,e,a,n,o,f,i){var u=0,s=0,c=0,h=o*o;for(t.error(e,a,r,f,n);n>s;++s)c=f[s]<=h,i[s]=c,u+=c;return u}function o(){throw new Error("MotionEstimator can't create instance.")}var f=o.prototype;return f.constructor=o,o.ransac=function(o,f,i,u,c,h,d,l){if("undefined"==typeof l&&(l=1e3),c<o.size)return!1;var p=o.size,v=l,g=0,y=!1,w=[],x=[],m=!1,_=h.cols,b=h.rows,M=h.type|s,B=a.getBuffer(_*b<<3),k=a.getBuffer(c),I=a.getBuffer(c<<2),z=new n(_,b,M,B.data),A=new n(c,1,r.U8C1_t,k.data),C=-1,D=0,S=0,O=I.f32;if(c===p){if(f.run(i,u,z,c)<=0)return a.getBuffer(B),a.getBuffer(k),a.getBuffer(I),!1;if(z.copy_to(h),d)for(;--c>=0;)d.data[c]=1;return a.putBuffer(B),a.putBuffer(k),a.putBuffer(I),!0}for(;v>g;++g){if(m=t(f,i,u,p,c,w,x),!m){if(0===g)return a.putBuffer(B),a.putBuffer(k),a.putBuffer(I),!1;break}S=f.run(w,x,z,p),0>=S||(D=e(f,z,i,u,c,o.thresh,O,A.data),D>Math.max(C,p-1)&&(z.copy_to(h),C=D,d&&A.copy_to(d),v=o.update((c-D)/c,v),y=!0))}return a.putBuffer(B),a.putBuffer(k),a.putBuffer(I),y},o.lmeds=function(o,f,u,c,h,d,l,p){if("undefined"==typeof p&&(p=1e3),h<o.size)return!1;var v=o.size,g=p,y=0,w=!1,x=[],m=[],_=!1,b=d.cols,M=d.rows,B=d.type|s,k=a.getBuffer(b*M<<3),I=a.getBuffer(h),z=a.getBuffer(h<<2),A=new n(b,M,B,k.data),C=new n(h,1,r.U8_t|s,I.data),D=0,S=0,O=z.f32,R=1e9,q=0,F=0;if(o.eps=.45,g=o.update_iters(o.eps,g),h===v){if(f.run(u,c,A,h)<=0)return a.putBuffer(k),a.putBuffer(I),a.putBuffer(z),!1;if(A.copy_to(d),l)for(;--h>=0;)l.data[h]=1;return a.putBuffer(k),a.putBuffer(I),a.putBuffer(z),!0}for(;g>y;++y){if(_=t(f,u,c,v,h,x,m),!_){if(0===y)return a.putBuffer(k),a.putBuffer(I),a.putBuffer(z),!1;break}S=f.run(x,m,A,v),0>=S||(f.error(u,c,A,O,h),F=i.median(O,0,h-1),R>F&&(R=F,A.copy_to(d),w=!0))}return w&&(q=2.5*1.4826*(1+5/(h-v))*Math.sqrt(R),q=Math.max(q,.001),D=e(f,d,u,c,h,q,O,C.data),l&&C.copy_to(l),w=D>=v),a.putBuffer(k),a.putBuffer(I),a.putBuffer(z),w},o}();e.Affine2d=y,e.HomoGraphy2d=w,e.Ransac_t=x,e.MotionEstimator=m,e.Estimator=m}(window),function(t){"use strict";function r(t,r,e,a){for(var n=0,o=t.channel,f=t.cols,u=t.rows,s=t.data,c=r.data,h=f/e,d=u/a,l=h*d*65536|0,p=0,v=0,g=0,y=0,w=0,x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=0,z=0,A=0,C=0,D=i.getBuffer(e*o<<2),S=i.getBuffer(e*o<<2),O=i.getBuffer(2*f*3<<2),R=D.i32,q=S.i32,F=O.i32;e>p;p++){for(b=p*h,M=b+h,w=b+1-1e-6|0,x=0|M,w=Math.min(w,f-1),x=Math.min(x,f-1),w>b&&(F[_++]=p*o|0,F[_++]=(w-1)*o|0,F[_++]=256*(w-b)|0,n++),g=w;x>g;g++)n++,F[_++]=p*o|0,F[_++]=g*o|0,F[_++]=256;M-x>.001&&(n++,F[_++]=p*o|0,F[_++]=x*o|0,F[_++]=256*(M-x)|0)}for(p=0;e*o>p;p++)R[p]=q[p]=0;for(v=0,y=0;u>y;y++){for(B=f*y,_=0;n>_;_++)for(I=F[3*_],w=F[3*_+1],z=F[3*_+2],m=0;o>m;m++)R[I+m]+=s[B+w+m]*z;if(y+1>=(v+1)*d||y===u-1){if(A=256*Math.max(y+1-(v+1)*d,0)|0,C=256-A,k=e*v,0>=A)for(p=0;e*o>p;p++)c[k+p]=Math.min(Math.max((q[p]+256*R[p])/l,0),255),q[p]=R[p]=0;else for(p=0;e*o>p;p++)c[k+p]=Math.min(Math.max((q[p]+R[p]*C)/l,0),255),q[p]=R[p]*A,R[p]=0;v++}else for(p=0;e*o>p;p++)q[p]+=256*R[p],R[p]=0}i.putBuffer(S),i.putBuffer(D),i.putBuffer(O)}function e(t,r,e,a){for(var n=0,o=t.channel,f=t.cols,u=t.rows,s=t.data,c=r.data,h=f/e,d=u/a,l=1/(h*d),p=0,v=0,g=0,y=0,w=0,x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=0,z=0,A=0,C=0,D=i.getBuffer(e*o<<2),S=i.getBuffer(e*o<<2),O=i.getBuffer(2*f*3<<2),R=D.f32,q=S.f32,F=O.f32;e>p;p++){for(b=p*h,M=b+h,w=b+1-1e-6|0,x=0|M,w=Math.min(w,f-1),x=Math.min(x,f-1),w>b&&(n++,F[_++]=(w-1)*o|0,F[_++]=p*o|0,F[_++]=(w-b)*l),g=w;x>g;g++)n++,F[_++]=g*o|0,F[_++]=p*o|0,F[_++]=l;M-x>.001&&(n++,F[_++]=x*o|0,F[_++]=p*o|0,F[_++]=(M-x)*l)}for(p=0;e*o>p;p++)R[p]=q[p]=0;for(v=0,y=0;u>y;y++){for(B=f*y,_=0;n>_;_++)for(w=0|F[3*_],I=0|F[3*_+1],z=F[3*_+2],m=0;o>m;m++)R[I+m]+=s[B+w+m]*z;if(y+1>=(v+1)*d||y===u-1){if(A=Math.max(y+1-(v+1)*d,0),C=1-A,k=e*v,Math.abs(A)<.001)for(p=0;e*o>p;p++)c[k+p]=q[p]+R[p],q[p]=R[p]=0;else for(p=0;e*o>p;p++)c[k+p]=q[p]+R[p]*C,q[p]=R[p]*A,R[p]=0;v++}else for(p=0;e*o>p;p++)q[p]+=R[p],R[p]=0}i.putBuffer(S),i.putBuffer(D),i.putBuffer(O)}function a(t,r,e,a,n,o,f,i){for(var u=0,s=0,c=0,h=0,d=0,l=0,p=0,v=0,g=0,y=o[0],w=0,x=a<<1,m=3*a,_=a<<2;n>u;++u){for(l=r[h],s=0;i>s;++s)t[s]=l;for(s=0;a-2>=s;s+=2)t[s+i]=r[h+s],t[s+i+1]=r[h+s+1];for(;a>s;++s)t[s+i]=r[h+s];for(l=r[h+a-1],s=a;i+a>s;++s)t[s+i]=l;for(s=0;a-4>=s;s+=4){for(l=t[s]*y,p=t[s+1]*y,v=t[s+2]*y,g=t[s+3]*y,c=1;f>c;++c)w=o[c],l+=t[c+s]*w,p+=t[c+s+1]*w,v+=t[c+s+2]*w,g+=t[c+s+3]*w;e[d+s]=Math.min(l>>8,255),e[d+s+1]=Math.min(p>>8,255),e[d+s+2]=Math.min(v>>8,255),e[d+s+3]=Math.min(g>>8,255)}for(;a>s;++s){for(l=t[s]*y,c=1;f>c;++c)l+=t[c+s]*o[c];e[d+s]=Math.min(l>>8,255)}h+=a,d+=a}for(u=0;a>u;++u){for(l=e[u],s=0;i>s;++s)t[s]=l;for(c=u,s=0;n-2>=s;s+=2,c+=x)t[s+i]=e[c],t[s+i+1]=e[c+a];for(;n>s;++s,c+=a)t[s+i]=e[c];for(l=e[(n-1)*a+u],s=n;i+n>s;++s)t[s+i]=l;for(d=u,s=0;n-4>=s;s+=4,d+=_){for(l=t[s]*y,p=t[s+1]*y,v=t[s+2]*y,g=t[s+3]*y,c=1;f>c;++c)w=o[c],l+=t[c+s]*w,p+=t[c+s+1]*w,v+=t[c+s+2]*w,g+=t[c+s+3]*w;e[d]=Math.min(l>>8,255),e[d+a]=Math.min(p>>8,255),e[d+x]=Math.min(v>>8,255),e[d+m]=Math.min(g>>8,255)}for(;n>s;++s,d+=a){for(l=t[s]*y,c=1;f>c;++c)l+=t[c+s]*o[c];e[d]=Math.min(l>>8,255)}}}function n(t,r,e,a,n,o,f,i){for(var u=0,s=0,c=0,h=0,d=0,l=0,p=0,v=0,g=0,y=o[0],w=0,x=a<<1,m=3*a,_=a<<2;n>u;++u){for(l=r[h],s=0;i>s;++s)t[s]=l;for(s=0;a-2>=s;s+=2)t[s+i]=r[h+s],t[s+i+1]=r[h+s+1];for(;a>s;++s)t[s+i]=r[h+s];for(l=r[h+a-1],s=a;i+a>s;++s)t[s+i]=l;for(s=0;a-4>=s;s+=4){for(l=t[s]*y,p=t[s+1]*y,v=t[s+2]*y,g=t[s+3]*y,c=1;f>c;++c)w=o[c],l+=t[c+s]*w,p+=t[c+s+1]*w,v+=t[c+s+2]*w,g+=t[c+s+3]*w;e[d+s]=l,e[d+s+1]=p,e[d+s+2]=v,e[d+s+3]=g}for(;a>s;++s){for(l=t[s]*y,c=1;f>c;++c)l+=t[c+s]*o[c];e[d+s]=l}h+=a,d+=a}for(u=0;a>u;++u){for(l=e[u],s=0;i>s;++s)t[s]=l;for(c=u,s=0;n-2>=s;s+=2,c+=x)t[s+i]=e[c],t[s+i+1]=e[c+a];for(;n>s;++s,c+=a)t[s+i]=e[c];for(l=e[(n-1)*a+u],s=n;i+n>s;++s)t[s+i]=l;for(d=u,s=0;n-4>=s;s+=4,d+=_){for(l=t[s]*y,p=t[s+1]*y,v=t[s+2]*y,g=t[s+3]*y,c=1;f>c;++c)w=o[c],l+=t[c+s]*w,p+=t[c+s+1]*w,v+=t[c+s+2]*w,g+=t[c+s+3]*w;e[d]=l,e[d+a]=p,e[d+x]=v,e[d+m]=g}for(;n>s;++s,d+=a){for(l=t[s]*y,c=1;f>c;++c)l+=t[c+s]*o[c];e[d]=l}}}var o=t.Igata,f=o,i=f.Cache,u=f.Calc,s=f.Matrix_t,c=f.COLOR_RGBA2GRAY,h=f.COLOR_BGRA2GRAY,d=f.COLOR_BGR2GRAY,l=f.COLOR_RGB2GRAY,p=f.BOX_BLUR_NOSCALE,v=f.U8_t,g=f.S32_t,y=function(){function t(){throw new Error("Processing can't create instance.")}var o=t.prototype;return o.constructor=t,t.grayscale=function(t,r,e,a,n){"undefined"==typeof n&&(n=c);var o=0,f=0,i=0,u=0,s=0,p=0,v=4899,g=9617,y=1868,w=4;(n===h||n===d)&&(v=1868,y=4899),(n===l||n===d)&&(w=3);var x=w<<1,m=3*w|0;a.resize(r,e,1);var _,b=a.data;for(f=0;e>f;++f,u+=r,i+=r*w){for(o=0,s=i,p=u,_=r-4;_>=o;o+=4,s+=w<<2,p+=4)b[p]=t[s]*v+t[s+1]*g+t[s+2]*y+8192>>14,b[p+1]=t[s+w]*v+t[s+w+1]*g+t[s+w+2]*y+8192>>14,b[p+2]=t[s+x]*v+t[s+x+1]*g+t[s+x+2]*y+8192>>14,b[p+3]=t[s+m]*v+t[s+m+1]*g+t[s+m+2]*y+8192>>14;for(;r>o;++o,++p,s+=w)b[p]=t[s]*v+t[s+1]*g+t[s+2]*y+8192>>14}},t.resample=function(t,a,n,o){var f=t.rows,i=t.cols;f>o&&i>n&&(a.resize(n,o,t.channel),t.type&v&&a.type&v&&256>f*i/(o*n)?r(t,a,n,o):e(t,a,n,o))},t.boxGray=function(t,r,e,a){"undefined"==typeof a&&(a=0);var n=t.cols,o=t.rows,f=o<<1,u=n<<1,s=0,c=0,h=0,d=0,l=(e<<1)+1|0,v=e+1|0,g=v+1|0,y=a&p?1:1/(l*l),w=i.getBuffer(n*o<<2),x=0,m=0,_=0,b=0,M=0,B=w.i32,k=t.data,I=0;for(r.resize(n,o,t.channel),h=0;o>h;++h){for(m=h,x=v*k[_],s=_+1|0,d=_+e|0;d>=s;++s)x+=k[s];for(b=_+v|0,M=_,I=k[M],c=0;e>c;++c,m+=o)B[m]=x,x+=k[b]-I,b++;for(;n-g>c;c+=2,m+=f)B[m]=x,x+=k[b]-k[M],B[m+o]=x,x+=k[b+1]-k[M+1],b+=2,M+=2;for(;n-v>c;++c,m+=o)B[m]=x,x+=k[b]-k[M],b++,M++;for(I=k[b-1];n>c;++c,m+=o)B[m]=x,x+=I-k[M],M++;_+=n}if(_=0,k=r.data,1===y)for(h=0;n>h;++h){for(m=h,x=v*B[_],s=_+1|0,d=_+e|0;d>=s;++s)x+=B[s];for(b=_+v,M=_,I=B[M],c=0;e>c;++c,m+=n)k[m]=x,x+=B[b]-I,b++;for(;o-g>c;c+=2,m+=u)k[m]=x,x+=B[b]-B[M],k[m+n]=x,x+=B[b+1]-B[M+1],b+=2,M+=2;for(;o-v>c;++c,m+=n)k[m]=x,x+=B[b]-B[M],b++,M++;for(I=B[b-1];o>c;++c,m+=n)k[m]=x,x+=I-B[M],M++;_+=o}else for(h=0;n>h;++h){for(m=h,x=v*B[_],s=_+1|0,d=_+e|0;d>=s;++s)x+=B[s];for(b=_+v,M=_,I=B[M],c=0;e>c;++c,m+=n)k[m]=x*y,x+=B[b]-I,b++;for(;o-g>c;c+=2,m+=u)k[m]=x*y,x+=B[b]-B[M],k[m+n]=x*y,x+=B[b+1]-B[M+1],b+=2,M+=2;for(;o-v>c;++c,m+=n)k[m]=x*y,x+=B[b]-B[M],b++,M++;for(I=B[b-1];o>c;++c,m+=n)k[m]=x*y,x+=I-B[M],M++;_+=o}i.putBuffer(w)},t.box_blur_gray=function(r,e,a,n){t.boxGray(r,e,a,n)},t.gaussian=function(t,r,e,o){"undefined"==typeof o&&(o=0),"undefined"==typeof e&&(e=0),e=0===e?2*Math.max(1,4*o+1-1e-8)+1|0:e;var f=e>>1,s=t.cols,c=t.rows,h=t.type,d=h&v;r.resize(s,c,t.channel);var l,p,y=t.data,w=r.data,x=e+Math.max(c,s)|0,m=i.getBuffer(x<<2),_=i.getBuffer(e<<2);d?(l=m.i32,p=_.i32):h&g?(l=m.i32,p=_.f32):(l=m.f32,p=_.f32),u.kernel(e,o,p,h),d?a(l,y,w,s,c,p,e,f):n(l,y,w,s,c,p,e,f),i.putBuffer(m),i.putBuffer(_)},t.gaussian_blur=function(r,e,a,n){t.gaussian(r,e,a,n)},t.transform=function(t,r,e,a){for(var n,o=t.data,f=t.cols,i=t.rows,u=f,s=0,c=Math.PI,h=Math.round((c-s)/e),d=Math.round((2*(f+i)+1)/r),l=1/r,p=new Int32Array((h+2)*(d+2)),v=new Float32Array(h),g=new Float32Array(h),y=0,w=s;h>y;y++)v[y]=Math.sin(w)*l,g[y]=Math.cos(w)*l,w+=e;var x;for(k=0;i>k;k++)for(x=0;f>x;x++)if(0!==o[k*u+x])for(y=0;h>y;y++)n=Math.round(x*g[y]+k*v[y]),n+=(d-1)/2,p[(y+1)*(d+2)+n+1]+=1;var m,_=[];for(n=0;d>n;n++)for(y=0;h>y;y++)m=(y+1)*(d+2)+n+1,p[m]>a&&p[m]>p[m-1]&&p[m]>=p[m+1]&&p[m]>p[m-d-2]&&p[m]>=p[m+d+2]&&_.push(m);_.sort(function(t,r){return p[t]>p[r]||p[t]===p[r]&&r>t});var b,M,B,k,I=Math.min(h*d,_.length),z=1/(d+2),A=[];for(k=0;I>k;k++)b=_[k],y=Math.floor(b*z)-1,n=b-(y+1)*(d+2)-1,M=(n-.5*(d-1))*r,B=y*e,A.push([M,B]);return A},t.hough_transform=function(r,e,a,n){return t.transform(r,e,a,n)},t.pyrdown=function(t,r,e,a){"undefined"==typeof e&&(e=0),"undefined"==typeof a&&(a=0);var n=t.cols,o=t.rows,f=n>>1,i=o>>1,u=f-(e<<1),s=i-(a<<1),c=0,h=0,d=e+a*n,l=0,p=0,v=0;r.resize(f,i,t.channel);var g=t.data,y=r.data;for(h=0;s>h;++h){for(l=d,v=p,c=0;u-2>=c;c+=2,v+=2,l+=4)y[v]=g[l]+g[l+1]+g[l+n]+g[l+n+1]+2>>2,y[v+1]=g[l+2]+g[l+3]+g[l+n+2]+g[l+n+3]+2>>2;for(;u>c;++c,++v,l+=2)y[v]=g[l]+g[l+1]+g[l+n]+g[l+n+1]+2>>2;d+=n<<1,p+=f}},t.scharrDerivatives=function(t,r){var e,a,n,o,f,u,s,c,h=t.cols,d=t.rows,l=h<<1,p=0,y=0,w=0,x=0,m=0,_=0,b=0;r.resize(h,d,2);var M=t.data,B=r.data,k=i.getBuffer(h+2<<2),I=i.getBuffer(h+2<<2);for(t.type&v||t.type&g?(s=k.i32,c=I.i32):(s=k.f32,c=I.f32);d>y;++y,m+=h){for(x=(y>0?y-1:1)*h|0,_=(d-1>y?y+1:d-2)*h|0,b=y*l|0,p=0,w=1;h-2>=p;p+=2,w+=2)e=M[x+p],a=M[_+p],s[w]=3*(e+a)+10*M[m+p],c[w]=a-e,e=M[x+p+1],a=M[_+p+1],s[w+1]=3*(e+a)+10*M[m+p+1],c[w+1]=a-e;for(;h>p;++p,++w)e=M[x+p],a=M[_+p],s[w]=3*(e+a)+10*M[m+p],c[w]=a-e;for(p=h+1|0,s[0]=s[1],s[p]=s[h],c[0]=c[1],c[p]=c[h],p=0;h-4>=p;p+=4)e=c[p+2],a=c[p+1],n=c[p+3],o=c[p+4],f=s[p+2],u=s[p+3],B[b++]=f-s[p],B[b++]=3*(e+c[p])+10*a,B[b++]=u-s[p+1],B[b++]=3*(n+a)+10*e,B[b++]=s[p+4]-f,B[b++]=3*(o+e)+10*n,B[b++]=s[p+5]-u,B[b++]=3*(c[p+5]+n)+10*o;for(;h>p;++p)B[b++]=s[p+2]-s[p],B[b++]=3*(c[p+2]+c[p])+10*c[p+1]}i.putBuffer(k),i.putBuffer(I)},t.scharr_derivatives=function(r,e){t.scharrDerivatives(r,e)},t.sobelDerivatives=function(t,r){var e,a,n,o,f,u,s,c,h=t.cols,d=t.rows,l=h<<1,p=0,y=0,w=0,x=0,m=0,_=0,b=0;r.resize(h,d,2);var M=t.data,B=r.data,k=i.getBuffer(h+2<<2),I=i.getBuffer(h+2<<2);for(t.type&v||t.type&g?(s=k.i32,c=I.i32):(s=k.f32,c=I.f32);d>y;++y,m+=h){for(x=(y>0?y-1:1)*h|0,_=(d-1>y?y+1:d-2)*h|0,b=y*l|0,p=0,w=1;h-2>=p;p+=2,w+=2)e=M[x+p],a=M[_+p],s[w]=e+a+2*M[m+p],c[w]=a-e,e=M[x+p+1],a=M[_+p+1],s[w+1]=e+a+2*M[m+p+1],c[w+1]=a-e;for(;h>p;++p,++w)e=M[x+p],a=M[_+p],s[w]=e+a+2*M[m+p],c[w]=a-e;for(p=h+1|0,s[0]=s[1],s[p]=s[h],c[0]=c[1],c[p]=c[h],p=0;h-4>=p;p+=4)e=c[p+2],a=c[p+1],n=c[p+3],o=c[p+4],f=s[p+2],u=s[p+3],B[b++]=f-s[p],B[b++]=e+c[p]+2*a,B[b++]=u-s[p+1],B[b++]=n+a+2*e,B[b++]=s[p+4]-f,B[b++]=o+e+2*n,B[b++]=s[p+5]-u,B[b++]=c[p+5]+n+2*o;for(;h>p;++p)B[b++]=s[p+2]-s[p],B[b++]=c[p+2]+c[p]+2*c[p+1]}i.putBuffer(k),i.putBuffer(I)},t.sobel_derivatives=function(r,e){t.sobelDerivatives(r,e)},t.integralImage=function(t,r,e,a){var n=0|t.cols,o=0|t.rows,f=t.data,i=n+1|0,u=0,s=0,c=0,h=0,d=0,l=0,p=0,v=0;if(r&&e){for(;i>d;++d)r[d]=0,e[d]=0;for(c=i+1|0,h=1,d=0,v=0;o>d;++d,++c,++h){for(u=s=0,l=0;n-2>=l;l+=2,v+=2,c+=2,h+=2)p=f[v],u+=p,s+=p*p,r[c]=r[h]+u,e[c]=e[h]+s,p=f[v+1],u+=p,s+=p*p,r[c+1]=r[h+1]+u,e[c+1]=e[h+1]+s;for(;n>l;++l,++v,++c,++h)p=f[v],u+=p,s+=p*p,r[c]=r[h]+u,e[c]=e[h]+s}}else if(r){for(;i>d;++d)r[d]=0;for(c=i+1|0,h=1,d=0,v=0;o>d;++d,++c,++h){for(u=0,l=0;n-2>=l;l+=2,v+=2,c+=2,h+=2)u+=f[v],r[c]=r[h]+u,u+=f[v+1],r[c+1]=r[h+1]+u;for(;n>l;++l,++v,++c,++h)u+=f[v],r[c]=r[h]+u}}else if(e){for(;i>d;++d)e[d]=0;for(c=i+1|0,h=1,d=0,v=0;o>d;++d,++c,++h){for(s=0,l=0;n-2>=l;l+=2,v+=2,c+=2,h+=2)p=f[v],s+=p*p,e[c]=e[h]+s,p=f[v+1],s+=p*p,e[c+1]=e[h+1]+s;for(;n>l;++l,++v,++c,++h)p=f[v],s+=p*p,e[c]=e[h]+s}}if(a){for(d=0;i>d;++d)a[d]=0;for(c=i+1|0,h=0,d=0,v=0;o>d;++d,++c,++h){for(l=0;n-2>=l;l+=2,v+=2,c+=2,h+=2)a[c]=f[v]+a[h],a[c+1]=f[v+1]+a[h+1];for(;n>l;++l,++v,++c,++h)a[c]=f[v]+a[h]}for(c=i+n|0,h=n,d=0;o>d;++d,c+=i,h+=i)a[c]+=a[h];for(l=n-1;l>0;--l)for(c=l+o*i,h=c-i,d=o;d>0;--d,c-=i,h-=i)a[c]+=a[h]+a[h+1]}},t.compute_integral_image=function(r,e,a,n){t.integralImage(r,e,a,n)},t.histogram=function(t,r){var e=t.cols,a=t.rows,n=t.data;r.resize(e,a,t.channel);var o,f,u=r.data,s=e*a,c=0,h=0,d=i.getBuffer(1024);for(o=d.i32;256>c;++c)o[c]=0;for(c=0;s>c;++c)++o[n[c]];for(h=o[0],c=1;256>c;++c)h=o[c]+=h;for(f=255/s,c=0;s>c;++c)u[c]=o[n[c]]*f+.5|0;i.putBuffer(d)},t.equalize_histogram=function(r,e){t.histogram(r,e)},t.canny=function(r,e,a,n){var o=r.cols,u=r.rows;r.data;e.resize(o,u,r.channel);var c=e.data,h=0,d=0,l=0,p=o<<1,v=0,g=0,y=0,w=0,x=0,m=0,_=0,b=0,M=i.getBuffer(u*p<<2),B=i.getBuffer(3*(o+2)<<2),k=i.getBuffer((u+2)*(o+2)<<2),I=i.getBuffer(u*o<<2),z=B.i32,A=k.i32,C=I.i32,D=M.i32,S=new s(o,u,f.S32C2_t,M.data),O=1,R=o+2+1|0,q=2*(o+2)+1|0,F=o+2|0,L=F+1|0,E=0;for(t.sobelDerivatives(r,S),a>n&&(h=a,a=n,n=h),h=3*(o+2)|0;--h>=0;)z[h]=0;for(h=(u+2)*(o+2)|0;--h>=0;)A[h]=0;for(;o>d;++d,l+=2)w=D[l],x=D[l+1],z[R+d]=(w^w>>31)-(w>>31)+((x^x>>31)-(x>>31));for(h=1;u>=h;++h,l+=p){if(h===u)for(d=q+o;--d>=q;)z[d]=0;else for(d=0;o>d;d++)w=D[l+(d<<1)],x=D[l+(d<<1)+1],z[q+d]=(w^w>>31)-(w>>31)+((x^x>>31)-(x>>31));for(v=l-p|0,A[L-1]=0,g=0,d=0;o>d;++d,v+=2){if(y=z[R+d],y>a)if(w=D[v],x=D[v+1],m=w^x,w=(w^w>>31)-(w>>31)|0,x=(x^x>>31)-(x>>31)|0,_=13573*w,b=_+(w+w<<15),x<<=15,_>x){if(y>z[R+d-1]&&y>=z[R+d+1]){y>n&&!g&&2!==A[L+d-F]?(A[L+d]=2,g=1,C[E++]=L+d):A[L+d]=1;continue}}else if(x>b){if(y>z[O+d]&&y>=z[q+d]){y>n&&!g&&2!==A[L+d-F]?(A[L+d]=2,g=1,C[E++]=L+d):A[L+d]=1;continue}}else if(m=0>m?-1:1,y>z[O+d-m]&&y>z[q+d+m]){y>n&&!g&&2!==A[L+d-F]?(A[L+d]=2,g=1,C[E++]=L+d):A[L+d]=1;continue}A[L+d]=0,g=0}A[L+o]=0,L+=F,d=O,O=R,R=q,q=d}for(d=L-F-1,h=0;F>h;++h,++d)A[d]=0;for(;E>0;)L=C[--E],L-=F+1,1===A[L]&&(A[L]=2,C[E++]=L),L+=1,1===A[L]&&(A[L]=2,C[E++]=L),L+=1,1===A[L]&&(A[L]=2,C[E++]=L),L+=F,1===A[L]&&(A[L]=2,C[E++]=L),L-=2,1===A[L]&&(A[L]=2,C[E++]=L),L+=F,1===A[L]&&(A[L]=2,C[E++]=L),L+=1,1===A[L]&&(A[L]=2,C[E++]=L),L+=1,1===A[L]&&(A[L]=2,C[E++]=L);for(L=F+1,O=0,h=0;u>h;++h,L+=F)for(d=0;o>d;++d)c[O++]=255*(2===A[L+d]);i.putBuffer(M),i.putBuffer(B),i.putBuffer(k),i.putBuffer(I)},t.perspective=function(t,r,e,a){"undefined"==typeof a&&(a=0);var n,o=0|t.cols,f=0|t.rows,i=0|r.cols,u=0|r.rows,s=t.data,c=r.data,h=0,d=0,l=0,p=0,v=0,g=0,y=0,w=0,x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=e.data,z=I[0],A=I[1],C=I[2],D=I[3],S=I[4],O=I[5],R=I[6],q=I[7],F=I[8];for(n=0;u>d;++d)for(w=A*d+C,x=S*d+O,m=q*d+F,h=0;i>h;++h,++n,w+=z,x+=D,m+=R)_=1/m,g=w*_,y=x*_,p=0|g,v=0|y,g>0&&y>0&&o-1>p&&f-1>v?(b=Math.max(g-p,0),M=Math.max(y-v,0),l=o*v+p|0,B=s[l]+b*(s[l+1]-s[l]),k=s[l+o]+b*(s[l+o+1]-s[l+o]),c[n]=B+M*(k-B)):c[n]=a},t.warp_perspective=function(r,e,a,n){t.perspective(r,e,a,n)},t.affine=function(t,r,e,a){"undefined"==typeof a&&(a=0);var n,o=t.cols,f=t.rows,i=r.cols,u=r.rows,s=t.data,c=r.data,h=0,d=0,l=0,p=0,v=0,g=0,y=0,w=0,x=0,m=0,_=0,b=e.data,M=b[0],B=b[1],k=b[2],I=b[3],z=b[4],A=b[5];for(n=0;u>d;++d)for(g=B*d+k,y=z*d+A,h=0;i>h;++h,++n,g+=M,y+=I)p=0|g,v=0|y,p>=0&&v>=0&&o-1>p&&f-1>v?(w=g-p,x=y-v,l=o*v+p,m=s[l]+w*(s[l+1]-s[l]),_=s[l+o]+w*(s[l+o+1]-s[l+o]),c[n]=m+x*(_-m)):c[n]=a},t.warp_affine=function(r,e,a,n){t.affine(r,e,a,n)},t.skinDetector=function(t,r){for(var e,a,n,o,f=t.width*t.height;f--;)o=4*f,e=t.data[o],a=t.data[o+1],n=t.data[o+2],e>95&&a>40&&n>20&&e>a&&e>n&&e-Math.min(a,n)>15&&Math.abs(e-a)>15?r[f]=255:r[f]=0},t.skindetector=function(r,e){t.skinDetector(r,e)},t}(),w=function(){function t(t){this.levels=0|t,this.data=new Array(t),this.pyrdown=y.pyrdown}var r=t.prototype;return r.constructor=t,r.allocate=function(t,r,e){for(var a=this.levels;--a>=0;)this.data[a]=new s(t>>a,r>>a,e)},r.build=function(t,r){"undefined"==typeof r&&(r=!0);var e=this.levels,a=this.data,n=2,o=t,f=a[0];if(!r)for(var i=t.cols*t.rows;--i>=0;)f.data[i]=t.data[i];for(f=this.data[1],this.pyrdown(o,f);e>n;++n)o=f,f=a[n],this.pyrdown(o,f)},t}();f.Processing=y,f.Pyramid_t=w}(window),function(t){"use strict";var r=t.Igata,e=r,a=e.Cache,n=function(){function t(t,r,e){for(var a=0,o=n;e>a;++a)t[a]=o[a<<1]+o[(a<<1)+1]*r;for(;25>a;++a)t[a]=t[a-e]}function r(t,r,e,a,n){for(var o=25,f=0,i=t[r],u=n,s=0,c=0,h=0;o>f;++f)a[f]=i-t[r+e[f]];for(f=0;16>f;f+=2)s=Math.min(a[f+1],a[f+2]),s=Math.min(s,a[f+3]),u>=s||(s=Math.min(s,a[f+4]),s=Math.min(s,a[f+5]),s=Math.min(s,a[f+6]),s=Math.min(s,a[f+7]),s=Math.min(s,a[f+8]),u=Math.max(u,Math.min(s,a[f])),u=Math.max(u,Math.min(s,a[f+9])));for(c=-u,f=0;16>f;f+=2)h=Math.max(a[f+1],a[f+2]),h=Math.max(h,a[f+3]),h=Math.max(h,a[f+4]),h=Math.max(h,a[f+5]),h>=c||(h=Math.max(h,a[f+6]),h=Math.max(h,a[f+7]),h=Math.max(h,a[f+8]),c=Math.min(c,Math.max(h,a[f])),c=Math.min(c,Math.max(h,a[f+9])));return-c-1}function e(){throw new Error("FastCorner can't create instance.")}var n=new Int32Array([0,3,1,3,2,2,3,1,3,0,3,-1,2,-2,1,-3,0,-3,-1,-3,-2,-2,-3,-1,-3,0,-3,1,-2,2,-1,3]),o=new Uint8Array(512),f=new Int32Array(25),i=new Int32Array(25),u=20,s=e.prototype;return s.constructor=e,e.setThreshold=function(t){u=Math.min(Math.max(t,0),255);for(var r=-255;255>=r;++r)o[r+255]=-u>r?1:r>u?2:0;return u},e.set_threshold=function(t){return e.setThreshold(t)},e.detect=function(e,n,s){"undefined"==typeof s&&(s=3);var c,h=8,d=25,l=e.data,p=e.cols,v=e.rows,g=0,y=0,w=0,x=0,m=0,_=0,b=a.getBuffer(3*p),M=a.getBuffer(3*(p+1)<<2),B=b.u8,k=M.i32,I=f,z=i,A=Math.max(3,s),C=Math.min(v-2,v-s),D=Math.max(3,s),S=Math.min(p-3,p-s),O=0,R=0,q=r,F=o,L=u,E=0,T=0,U=0,G=0,P=0,N=0,V=0,Y=0,j=0,H=0,Q=0,X=0;t(I,p,16);var K=I[0],J=I[1],W=I[2],Z=I[3],$=I[4],tt=I[5],rt=I[6],et=I[7],at=I[8],nt=I[9],ot=I[10],ft=I[11],it=I[12],ut=I[13],st=I[14],ct=I[15],ht=3*p;for(g=0;ht>g;++g)B[g]=0;for(g=A;C>g;++g){for(V=g*p+D|0,_=(g-3)%3,N=_*p|0,P=_*(p+1)|0,y=0;p>y;++y)B[N+y]=0;if(G=0,C-1>g)for(y=D;S>y;++y,++V)if(E=l[V],T=-E+255,U=F[T+l[V+K]]|F[T+l[V+at]],0!==U&&(U&=F[T+l[V+W]]|F[T+l[V+ot]],U&=F[T+l[V+$]]|F[T+l[V+it]],U&=F[T+l[V+rt]]|F[T+l[V+st]],0!==U)){if(U&=F[T+l[V+J]]|F[T+l[V+nt]],U&=F[T+l[V+Z]]|F[T+l[V+ft]],U&=F[T+l[V+tt]]|F[T+l[V+ut]],U&=F[T+l[V+et]]|F[T+l[V+ct]],1&U)for(x=E-L,O=0,w=0;d>w;++w)if(m=l[V+I[w]],x>m){if(++O,O>h){++G,k[P+G]=y,B[N+y]=q(l,V,I,z,L);break}}else O=0;if(2&U)for(x=E+L,O=0,w=0;d>w;++w)if(m=l[V+I[w]],m>x){if(++O,O>h){++G,k[P+G]=y,B[N+y]=q(l,V,I,z,L);break}}else O=0}if(k[P+p]=G,g!==A)for(_=(g-4+3)%3,Y=_*p|0,P=_*(p+1)|0,_=(g-5+3)%3,j=_*p|0,G=k[P+p],w=0;G>w;++w)y=k[P+w],H=y+1|0,Q=y-1|0,X=B[Y+y],X>B[Y+H]&&X>B[Y+Q]&&X>B[j+Q]&&X>B[j+y]&&X>B[j+H]&&X>B[N+Q]&&X>B[N+y]&&X>B[N+H]&&(c=n[R],c.x=y,c.y=g-1,c.score=X,R++)}return a.putBuffer(b),a.putBuffer(M),R},e}();n.setThreshold(20),e.FastCorner=n}(window),function(t){"use strict";var r=t.Igata,e=r;e.Yape06=function(){function t(t,r,e,a,n,o,f,i,u,s){var c=0,h=0,d=i*e+f|0,l=d;for(c=i;s>c;++c,d+=e,l=d)for(h=f;u>h;++h,++l)r[l]=-4*t[l]+t[l+n]+t[l-n]+t[l+o]+t[l-o]}function r(t,r,e,a,n,o,f){var i=-2*t[r]+t[r+a]+t[r-a],u=-2*t[r]+t[r+n]+t[r-n],s=t[r+o]+t[r-o]-t[r+f]-t[r-f],c=0|Math.sqrt((i-u)*(i-u)+4*s*s);return Math.min(Math.abs(e-c),Math.abs(-(e+c)))}function a(){throw new Error("Yape06 can't create instance.")}var n=e.Cache,o=a.prototype;return o.constructor=a,a.threshold=30,a.laplacian_threshold=a.threshold,a.thresholdMin=25,a.min_eigen_value_threshold=a.thresholdMin,a.detect=function(e,o,f){"undefined"==typeof f&&(f=5);var i,u=0,s=0,c=e.cols,h=e.rows,d=e.data,l=5,p=5*c|0,v=3+3*c|0,g=3-3*c|0,y=n.getBuffer(c*h<<2),w=y.i32,x=0,m=0,_=0,b=0,M=0,B=a.threshold,k=a.thresholdMin,I=0|Math.max(5,f),z=0|Math.max(3,f),A=0|Math.min(c-5,c-f),C=0|Math.min(h-3,h-f);for(u=c*h;--u>=0;)w[u]=0;for(t(d,w,c,h,l,p,I,z,A,C),m=z*c+I|0,s=z;C>s;++s,m+=c)for(u=I,_=m;A>u;++u,++_)x=w[_],(-B>x&&x<w[_-1]&&x<w[_+1]&&x<w[_-c]&&x<w[_+c]&&x<w[_-c-1]&&x<w[_+c-1]&&x<w[_-c+1]&&x<w[_+c+1]||x>B&&x>w[_-1]&&x>w[_+1]&&x>w[_-c]&&x>w[_+c]&&x>w[_-c-1]&&x>w[_+c-1]&&x>w[_-c+1]&&x>w[_+c+1])&&(b=r(d,_,x,l,p,v,g),b>k&&(i=o[M],i.x=u,i.y=s,i.score=b,++M,++u,++_));return n.putBuffer(y),M},a}()}(window),function(t){"use strict";var r=t.Igata,e=r,a=function(){function t(t,r,e){var a,n,o=0;for(a=e,n=0;a>n;n++,o++)a=Math.sqrt(e*e-n*n)+.5|0,r[o]=a+t*n;for(a--;n>a&&a>=0;a--,o++)n=Math.sqrt(e*e-a*a)+.5|0,r[o]=a+t*n;for(;n>-a;a--,o++)n=Math.sqrt(e*e-a*a)+.5|0,r[o]=a+t*n;for(n--;n>=0;n--,o++)a=-Math.sqrt(e*e-n*n)-.5|0,r[o]=a+t*n;for(;n>a;n--,o++)a=-Math.sqrt(e*e-n*n)-.5|0,r[o]=a+t*n;for(a++;0>=a;a++,o++)n=-Math.sqrt(e*e-a*a)-.5|0,r[o]=a+t*n;for(;-n>a;a++,o++)n=-Math.sqrt(e*e-a*a)-.5|0,r[o]=a+t*n;for(n++;0>n;n++,o++)a=Math.sqrt(e*e-n*n)+.5|0,r[o]=a+t*n;return r[o]=r[0],r[o+1]=r[1],o}function r(t,r,e){var a=0;return 0!==t[r+1]&&a++,0!==t[r-1]&&a++,0!==t[r+e]&&a++,0!==t[r+e+1]&&a++,0!==t[r+e-1]&&a++,0!==t[r-e]&&a++,0!==t[r-e+1]&&a++,0!==t[r-e-1]&&a++,a}function e(t,r,e,a,n){var o,f;if(e>0)for(r-=a*n,f=-n;n>=f;++f){for(o=-n;n>=o;++o)if(t[r+o]>e)return!1;r+=a}else for(r-=a*n,f=-n;n>=f;++f){for(o=-n;n>=o;++o)if(t[r+o]<e)return!1;r+=a}return!0}function a(t,r,e,a,n,o,f,i){var u=0,s=0,c=f-1|0,h=0,d=0,l=0,p=0,v=0;if(h=t[r+o[s]],n>=h)if(h>=a)if(d=t[r+o[c]],n>=d){if(d>=a)return void(e[r]=0);if(c++,l=t[r+o[c]],l>n)if(c++,p=t[r+o[c]],p>n)v=3;else{if(!(a>p))return void(e[r]=0);v=6}else if(c++,p=t[r+o[c]],p>n)v=7;else{if(!(a>p))return void(e[r]=0);v=2}}else if(c++,l=t[r+o[c]],l>n)if(c++,p=t[r+o[c]],p>n)v=3;else{if(!(a>p))return void(e[r]=0);v=6}else{if(!(a>l))return void(e[r]=0);if(c++,p=t[r+o[c]],p>n)v=7;else{if(!(a>p))return void(e[r]=0);v=2}}else{if(d=t[r+o[c]],d>n)return void(e[r]=0);if(c++,l=t[r+o[c]],l>n)return void(e[r]=0);if(c++,p=t[r+o[c]],p>n)return void(e[r]=0);v=1}else{if(d=t[r+o[c]],a>d)return void(e[r]=0);if(c++,l=t[r+o[c]],a>l)return void(e[r]=0);if(c++,p=t[r+o[c]],a>p)return void(e[r]=0);v=0}for(s=1;f>=s;s++)switch(h=t[r+o[s]],v){case 0:if(h>n){if(l=p,c++,p=t[r+o[c]],a>p)return void(e[r]=0);u-=h+l,v=0;break}if(a>h){if(l>n)return void(e[r]=0);if(p>n)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],p>n)return void(e[r]=0);u-=h+l,v=8;break}if(n>=l)return void(e[r]=0);if(n>=p)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],p>n){u-=h+l,v=3;break}if(a>p){u-=h+l,v=6;break}return void(e[r]=0);case 1:if(a>h){if(l=p,c++,p=t[r+o[c]],p>n)return void(e[r]=0);u-=h+l,v=1;break}if(h>n){if(a>l)return void(e[r]=0);if(a>p)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],a>p)return void(e[r]=0);u-=h+l,v=9;break}if(l>=a)return void(e[r]=0);if(p>=a)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],a>p){u-=h+l,v=2;break}if(p>n){u-=h+l,v=7;break}return void(e[r]=0);case 2:if(h>n)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],a>h){if(p>n)return void(e[r]=0);u-=h+l,v=4;break}if(p>n){u-=h+l,v=7;break}if(a>p){u-=h+l,v=2;break}return void(e[r]=0);case 3:if(a>h)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],h>n){if(a>p)return void(e[r]=0);u-=h+l,v=5;break}if(p>n){u-=h+l,v=3;break}if(a>p){u-=h+l,v=6;break}return void(e[r]=0);case 4:if(h>n)return void(e[r]=0);if(a>h){if(l=p,c++,p=t[r+o[c]],p>n)return void(e[r]=0);u-=h+l,v=1;break}if(p>=a)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],a>p){u-=h+l,v=2;break}if(p>n){u-=h+l,v=7;break}return void(e[r]=0);case 5:if(a>h)return void(e[r]=0);if(h>n){if(l=p,c++,p=t[r+o[c]],a>p)return void(e[r]=0);u-=h+l,v=0;break}if(n>=p)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],p>n){u-=h+l,v=3;break}if(a>p){u-=h+l,v=6;break}return void(e[r]=0);case 7:if(h>n)return void(e[r]=0);if(a>h)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],p>n){u-=h+l,v=3;break}if(a>p){u-=h+l,v=6;break}return void(e[r]=0);case 6:if(h>n)return void(e[r]=0);if(a>h)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],a>p){u-=h+l,v=2;break}if(p>n){u-=h+l,v=7;break}return void(e[r]=0);case 8:if(h>n){if(a>p)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],a>p)return void(e[r]=0);u-=h+l,v=9;break}if(a>h){if(l=p,c++,p=t[r+o[c]],p>n)return void(e[r]=0);u-=h+l,v=1;break}return void(e[r]=0);case 9:if(a>h){if(p>n)return void(e[r]=0);if(l=p,c++,p=t[r+o[c]],p>n)return void(e[r]=0);u-=h+l,v=8;break}if(h>n){if(l=p,c++,p=t[r+o[c]],a>p)return void(e[r]=0);u-=h+l,v=0;break}return void(e[r]=0)}e[r]=u+i*t[r]}function n(){throw new Error("Yape can't create instance.")}var o=function(){function r(r,e,a){var n=new Int32Array(1024);this.dirs=n,this.dirs_count=0|t(r,n,a),this.scores=new Int32Array(r*e),this.radius=0|a}var e=r.prototype;return e.constructor=r,r}(),f=n.prototype;return f.constructor=n,n.level_tables=[],n.tau=7,n.init=function(t,r,e,a){"undefined"==typeof a&&(a=1);var n;for(e=Math.min(e,7),e=Math.max(e,3),n=0;a>n;++n)this.level_tables[n]=new o(t>>n,r>>n,e)},n.detect=function(t,o,f){"undefined"==typeof f&&(f=4);var i,u=n.level_tables[0],s=0|u.radius,c=s-1|0,h=u.dirs,d=0|u.dirs_count,l=d>>1,p=t.data,v=0|t.cols,g=0|t.rows,y=v>>1,w=u.scores,x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=0,z=0|n.tau,A=0,C=0|Math.max(s+1,f),D=0|Math.max(s+1,f),S=0|Math.min(v-s-2,v-f),O=0|Math.min(g-s-2,g-f);for(_=D*v+C|0,m=D;O>m;++m,_+=v)for(x=C,b=_;S>x;++x,++b)M=p[b]+z,B=p[b]-z,B<p[b+s]&&p[b+s]<M&&B<p[b-s]&&p[b-s]<M?w[b]=0:a(p,b,w,B,M,h,l,d);for(_=D*v+C|0,m=D;O>m;++m,_+=v)for(x=C,b=_;S>x;++x,++b)I=w[b],k=Math.abs(I),5>k?(++x,++b):r(w,b,v)>=3&&e(w,b,I,y,s)&&(i=o[A],i.x=x,i.y=m,i.score=k,++A,x+=c,b+=c);return A},n}();e.Yape=a}(window),function(t){"use strict";var r=t.Igata,e=r;e.Haar=function(){function t(t,r){var e=.25*t.width+.5|0;return r.x<=t.x+e&&r.x>=t.x-e&&r.y<=t.y+e&&r.y>=t.y-e&&r.width<=1.5*t.width+.5|0&&1.5*r.width+.5|0>=t.width}function r(){throw new Error("Haar can't create instance.")}var e=r.prototype;return e.constructor=r,r.desity=.07,r.edges_density=r.desity,r.singleScale=function(t,e,a,n,o,f,i,u){var s,c,h,d,l,p,v,g,y,w,x,m,_,b,M,B,k,I,z,A,C,D,S,O,R,q,F=u.size[0]*i|0,L=u.size[1]*i|0,E=.5*i+1.5|0,T=E,U=o-F|0,G=f-L|0,P=o+1|0,N=1/(F*L),V=!0,Y=0,j=F,H=L*P,Q=H+F,X=F*L*255*r.desity|0,K=[];for(l=0;G>l;l+=T)for(Y=l*P,d=0;U>d;d+=E,Y+=E)if(v=t[Y]-t[Y+j]-t[Y+H]+t[Y+Q],n&&(p=n[Y]-n[Y+j]-n[Y+H]+n[Y+Q],X>p||20>v))d+=E,Y+=E;else{for(v*=N,g=(e[Y]-e[Y+j]-e[Y+H]+e[Y+Q])*N-v*v,y=g>0?Math.sqrt(g):1,w=u.complexClassifiers,b=w.length,V=!0,s=0;b>s;++s){for(x=w[s],k=x.threshold,m=x.simpleClassifiers,M=m.length,I=0,c=0;M>c;++c){if(_=m[c],z=0,C=_.features,B=C.length,1===_.tilted)for(h=0;B>h;++h)A=C[h],D=~~(d+A[0]*i)+~~(l+A[1]*i)*P,R=~~(A[2]*i),q=~~(A[3]*i),S=R*P,O=q*P,z+=(a[D]-a[D+R+S]-a[D-q+O]+a[D+R-q+S+O])*A[4];else for(h=0;B>h;++h)A=C[h],D=~~(d+A[0]*i)+~~(l+A[1]*i)*P,R=~~(A[2]*i),q=~~(A[3]*i),O=q*P,z+=(t[D]-t[D+R]-t[D+O]+t[D+O+R])*A[4];I+=z*N<_.threshold*y?_.left_val:_.right_val}if(k>I){V=!1;break}}V&&(K.push({x:d,y:l,width:F,height:L,neighbor:1,confidence:I}),d+=E,Y+=E)}return K},r.detect_single_scale=function(t,e,a,n,o,f,i,u){return r.singleScale(t,e,a,n,o,f,i,u)},r.multiScale=function(t,e,a,n,o,f,i,u,s){"undefined"==typeof u&&(u=1.2),"undefined"==typeof s&&(s=1);for(var c=i.size[0],h=i.size[1],d=[];o>s*c&&f>s*h;)d=d.concat(r.singleScale(t,e,a,n,o,f,s,i)),s*=u;return d},r.detect_multi_scale=function(t,e,a,n,o,f,i,u,s){return r.multiScale(t,e,a,n,o,f,i,u,s)},r.rectangles=function(r,e){"undefined"==typeof e&&(e=1);var a,n,o=r.length,f=[];for(a=0;o>a;++a)f[a]={parent:-1,element:r[a],rank:0};for(a=0;o>a;++a)if(f[a].element){for(var i=a;-1!==f[i].parent;)i=f[i].parent;for(n=0;o>n;++n)if(a!==n&&f[n].element&&t(f[a].element,f[n].element)){for(var u=n;-1!==f[u].parent;)u=f[u].parent;if(u!==i){f[i].rank>f[u].rank?f[u].parent=i:(f[i].parent=u,f[i].rank===f[u].rank&&f[u].rank++,i=u);for(var s,c=n;-1!==f[c].parent;)s=c,c=f[c].parent,f[s].parent=i;for(c=a;-1!==f[c].parent;)s=c,c=f[c].parent,f[s].parent=i}}}var h=[],d=0;for(a=0;o>a;a++){n=-1;var l=a;if(f[l].element){for(;-1!==f[l].parent;)l=f[l].parent;f[l].rank>=0&&(f[l].rank=~d++),n=~f[l].rank}h[a]=n}var p=[];for(a=0;d+1>a;++a)p[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};var v;for(a=0;o>a;++a)w=r[a],v=h[a],0===p[v].neighbors&&(p[v].confidence=w.confidence),++p[v].neighbors,p[v].x+=w.x,p[v].y+=w.y,p[v].width+=w.width,p[v].height+=w.height,p[v].confidence=Math.max(p[v].confidence,w.confidence);var g=[];for(a=0;d>a;++a)o=p[a].neighbors,o>=e&&g.push({x:(2*p[a].x+o)/(2*o),y:(2*p[a].y+o)/(2*o),width:(2*p[a].width+o)/(2*o),height:(2*p[a].height+o)/(2*o),neighbors:p[a].neighbors,confidence:p[a].confidence});var y=[];for(o=g.length,a=0;o>a;++a){var w=g[a],x=!0;for(n=0;o>n;++n){var m=g[n],_=.25*m.width+.5|0;if(a!==n&&w.x>=m.x-_&&w.y>=m.y-_&&w.x+w.width<=m.x+m.width+_&&w.y+w.height<=m.y+m.height+_&&(m.neighbors>Math.max(3,w.neighbors)||w.neighbors<3)){x=!1;break}}x&&y.push(w)}return y},r.group_rectangles=function(t,e){r.rectangles(t,e)},r}()}(window),function(t){"use strict";var r=t.Igata,e=r;e.Bbf=function(){function t(t,r){var e=.25*t.width+.5|0;return r.x<=t.x+e&&r.x>=t.x-e&&r.y<=t.y+e&&r.y>=t.y-e&&r.width<=1.5*t.width+.5|0&&1.5*r.width+.5|0>=t.width}function e(){throw new Error("Bbf can't create instance.")}var a=r.Processing,n=r.Matrix_t,o=r.U8_t,f=r.C1_t,i=new r.Pyramid_t(1),u=e.prototype;return u.constructor=e,e.interval=4,e.scale=1.1486,e.next=5,e.scaleTo=1,e.scale_to=e.scaleTo,e.prepare=function(t){for(var r=t.stage_classifier.length,e=0;r>e;e++)for(var a=t.stage_classifier[e].feature,n=t.stage_classifier[e].count,o=t.stage_classifier[e]._feature=new Array(n),f=0;n>f;f++)o[f]={size:a[f].size,px:new Array(a[f].size),pz:new Array(a[f].size),nx:new Array(a[f].size),nz:new Array(a[f].size)}},e.prepare_cascade=function(t){e.prepare(t)},e.pyramid=function(t,r,u,s){"undefined"==typeof s&&(s=4);var c,h=t.cols,d=t.rows,l=0,p=0,v=0,g=!1,y=t,w=t,x=o|f;e.interval=s,c=Math.pow(2,1/(s+1)),e.scale=c,e.next=s+1|0,e.scaleTo=Math.log(Math.min(h/r,d/u))/Math.log(c)|0;var m,_=4*(e.scaleTo+2*e.next)|0;for(i.levels!==_&&(i.levels=_,i.data=new Array(_),g=!0,i.data[0]=t),m=s,l=1;m>=l;++l)p=h/Math.pow(c,l)|0,v=d/Math.pow(c,l)|0,y=i.data[l<<2],(g||p!==y.cols||v!==y.rows)&&(i.data[l<<2]=new n(p,v,x),y=i.data[l<<2]),a.resample(t,y,p,v);for(m=e.scaleTo+2*e.next,
l=e.next;m>l;++l)w=i.data[(l<<2)-(this.next<<2)],y=i.data[l<<2],p=w.cols>>1,v=w.rows>>1,(g||p!==y.cols||v!==y.rows)&&(i.data[l<<2]=new n(p,v,x),y=i.data[l<<2]),a.pyrdown(w,y);for(m=e.scaleTo+2*e.next,l=2*e.next;m>l;++l)w=i.data[(l<<2)-(this.next<<2)],p=w.cols>>1,v=w.rows>>1,y=i.data[(l<<2)+1],(g||p!==y.cols||v!==y.rows)&&(i.data[(l<<2)+1]=new n(p,v,x),y=i.data[(l<<2)+1]),a.pyrdown(w,y,1,0),y=i.data[(l<<2)+2],(g||p!==y.cols||v!==y.rows)&&(i.data[(l<<2)+2]=new n(p,v,x),y=i.data[(l<<2)+2]),a.pyrdown(w,y,0,1),y=i.data[(l<<2)+3],(g||p!==y.cols||v!==y.rows)&&(i.data[(l<<2)+3]=new n(p,v,x),y=i.data[(l<<2)+3]),a.pyrdown(w,y,1,1);return i},e.build_pyramid=function(t,r,a,n){return e.pyramid(t,r,a,n)},e.detect=function(t,r){var a,n,o,f,i,u=e.scale,s=e.next,c=e.scaleTo,h=0,d=0,l=0,p=0,v=0,g=0,y=0,w=0,x=0,m=0,_=0,b=0,M=0,B=0,k=0,I=0,z=0,A=0,C=!0,D=!0,S=1,O=1,R=[0,1,0,1],q=[0,0,1,1],F=[],L=t.data,E=1,T=2,U=4,G=[],P=[0,0,0],N=[0,0,0],V=[0,0,0];for(h=0;c>h;h++){for(k=h<<2,I=L[k+(s<<3)].cols-(r.width>>2),z=L[k+(s<<3)].rows-(r.height>>2),N[0]=L[k].cols*E,N[1]=L[k+(s<<2)].cols*E,N[2]=L[k+(s<<3)].cols*E,V[0]=L[k].cols*U-I*U,V[1]=L[k+(s<<2)].cols*T-I*T,V[2]=L[k+(s<<3)].cols*E-I*E,w=r.stage_classifier.length,d=0;w>d;d++)for(o=r.stage_classifier[d].feature,n=r.stage_classifier[d]._feature,x=r.stage_classifier[d].count,l=0;x>l;l++)for(f=n[l],i=o[l],m=0|i.size,y=0;m>y;y++)f.px[y]=i.px[y]*E+i.py[y]*N[i.pz[y]],f.pz[y]=i.pz[y],f.nx[y]=i.nx[y]*E+i.ny[y]*N[i.nz[y]],f.nz[y]=i.nz[y];for(G[0]=L[k].data,G[1]=L[k+(s<<2)].data,y=0;4>y;y++)for(G[2]=L[k+(s<<3)+y].data,P[0]=R[y]*T+q[y]*(L[k].cols*T),P[1]=R[y]*E+q[y]*(L[k+(s<<2)].cols*E),P[2]=0,g=0;z>g;g++){for(v=0;I>v;v++){for(A=0,C=!0,w=r.stage_classifier.length,d=0;w>d;d++){for(A=0,a=r.stage_classifier[d].alpha,n=r.stage_classifier[d]._feature,x=r.stage_classifier[d].count,l=0;x>l;l++)if(f=n[l],b=G[f.pz[0]][P[f.pz[0]]+f.px[0]],M=G[f.nz[0]][P[f.nz[0]]+f.nx[0]],M>=b)A+=a[l<<1];else{for(D=!0,m=f.size,B=1;m>B;B++){if(f.pz[B]>=0&&(_=G[f.pz[B]][P[f.pz[B]]+f.px[B]],b>_)){if(M>=_){D=!1;break}b=_}if(f.nz[B]>=0&&(p=G[f.nz[B]][P[f.nz[B]]+f.nx[B]],p>M)){if(p>=b){D=!1;break}M=p}}A+=D?a[(l<<1)+1]:a[l<<1]}if(A<r.stage_classifier[d].threshold){C=!1;break}}C&&(F.push({x:(4*v+2*R[y])*S,y:(4*g+2*q[y])*O,width:r.width*S,height:r.height*O,neighbor:1,confidence:A}),++v,P[0]+=U,P[1]+=T,P[2]+=E),P[0]+=U,P[1]+=T,P[2]+=E}P[0]+=V[0],P[1]+=V[1],P[2]+=V[2]}S*=u,O*=u}return F},e.rectangles=function(r,e){"undefined"==typeof e&&(e=1);var a,n,o=r.length,f=[];for(a=0;o>a;++a)f[a]={parent:-1,element:r[a],rank:0};for(a=0;o>a;++a)if(f[a].element){for(var i=a;-1!==f[i].parent;)i=f[i].parent;for(n=0;o>n;++n)if(a!==n&&f[n].element&&t(f[a].element,f[n].element)){for(var u=n;-1!==f[u].parent;)u=f[u].parent;if(u!==i){f[i].rank>f[u].rank?f[u].parent=i:(f[i].parent=u,f[i].rank===f[u].rank&&f[u].rank++,i=u);for(var s,c=n;-1!==f[c].parent;)s=c,c=f[c].parent,f[s].parent=i;for(c=a;-1!==f[c].parent;)s=c,c=f[c].parent,f[s].parent=i}}}var h=[],d=0;for(a=0;o>a;a++){n=-1;var l=a;if(f[l].element){for(;-1!==f[l].parent;)l=f[l].parent;f[l].rank>=0&&(f[l].rank=~d++),n=~f[l].rank}h[a]=n}var p,v=[],g=d+1;for(a=0;g>a;++a)v[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(a=0;o>a;++a)x=r[a],p=h[a],0===v[p].neighbors&&(v[p].confidence=x.confidence),++v[p].neighbors,v[p].x+=x.x,v[p].y+=x.y,v[p].width+=x.width,v[p].height+=x.height,v[p].confidence=Math.max(v[p].confidence,x.confidence);var y=[];for(a=0;d>a;++a)o=v[a].neighbors,o>=e&&y.push({x:(2*v[a].x+o)/(2*o),y:(2*v[a].y+o)/(2*o),width:(2*v[a].width+o)/(2*o),height:(2*v[a].height+o)/(2*o),neighbors:v[a].neighbors,confidence:v[a].confidence});var w=[];for(o=y.length,a=0;o>a;++a){var x=y[a],m=!0;for(n=0;o>n;++n){var _=y[n],b=.25*_.width+.5|0;if(a!==n&&x.x>=_.x-b&&x.y>=_.y-b&&x.x+x.width<=_.x+_.width+b&&x.y+x.height<=_.y+_.height+b&&(_.neighbors>Math.max(3,x.neighbors)||x.neighbors<3)){m=!1;break}}m&&w.push(x)}return w},e.group_rectangles=function(t,r){return e.rectangles(t,r)},e}()}(window);